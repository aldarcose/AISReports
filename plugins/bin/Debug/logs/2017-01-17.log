2017-01-17 08:57:01.4459 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-17 08:57:01.4959 DEBUG Получено записей: 187
2017-01-17 08:57:04.6151 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2017-01-17 08:57:04.6151 DEBUG Parameters: @patterncode=, @operator=
2017-01-17 08:57:04.6441 DEBUG Result 
2017-01-17 08:57:04.6441 DEBUG нет шаблона для пользователя
2017-01-17 08:57:04.6441 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2017-01-17 08:57:04.6441 DEBUG Parameters: @patterncode 
2017-01-17 08:57:04.6571 DEBUG Result 
2017-01-17 08:57:04.7071 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2017-01-17 08:57:04.7071 DEBUG Parameters: @patterncode=, @operator=
2017-01-17 08:57:04.7191 DEBUG Result 
2017-01-17 08:57:04.7191 DEBUG нет шаблона для пользователя
2017-01-17 08:57:04.7191 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2017-01-17 08:57:04.7191 DEBUG Parameters: @patterncode 
2017-01-17 08:57:04.7191 DEBUG Result 
2017-01-17 08:57:05.1311 DEBUG Запрос: Select id, name, code, is_default, parent_id from codifiers.sp_kind_paid_tab order by id
2017-01-17 08:57:05.1311 DEBUG Получено записей: 9
2017-01-17 08:57:05.1441 DEBUG Запрос: Select id, name, code from codifiers.first_visit_condition_tab order by id
2017-01-17 08:57:05.1441 DEBUG Получено записей: 4
2017-01-17 08:57:05.1571 DEBUG Запрос: Select id, name, code, reestr, idsp, hospital_type_id, is_cure, is_inspection from codifiers.visit_purpose_common_tab order by id
2017-01-17 08:57:05.1571 DEBUG Получено записей: 22
2017-01-17 08:57:05.1741 DEBUG Запрос: Select id, name, code from codifiers.place_service_tab order by id
2017-01-17 08:57:05.1741 DEBUG Получено записей: 3
2017-01-17 08:57:05.1871 DEBUG Запрос: Select result_id, result, reestr, patient_state_id, reestr_rslt, reestr_ishod, _end from public.result_tab order by result_id
2017-01-17 08:57:05.1871 DEBUG Получено записей: 29
2017-01-17 08:57:05.2041 DEBUG Запрос: select id, name, code, bur_reestr_code from codifiers.travma_tab order by name;
2017-01-17 08:57:05.2041 DEBUG Получено записей: 15
2017-01-17 08:57:05.2181 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2017-01-17 08:57:05.2431 DEBUG Получено записей: 107
2017-01-17 08:57:05.6281 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-17 08:57:05.6421 DEBUG Получено записей: 107
2017-01-17 08:57:05.6421 DEBUG Запрос: select sp_napr_obosn_id,trim(obosn_name) as obosn_name FROM sp_napr_obosn_tab ORDER BY sp_napr_obosn_id;
2017-01-17 08:57:05.6551 DEBUG Получено записей: 8
2017-01-17 08:57:05.6551 DEBUG Запрос: SELECT sp_type_napr_id, sp_type_napr FROM sp_type_napr_tab ORDER BY 1;
2017-01-17 08:57:05.6551 DEBUG Получено записей: 9
2017-01-17 08:57:05.6781 DEBUG Запрос: select * from public.doctor_tab where sp_spec_doctor_id <> 900;
2017-01-17 08:57:05.7751 DEBUG Получено записей: 682
2017-01-17 08:57:31.7796 DEBUG Запрос: select id, code, name from codifiers.doctor_spec_tab order by 3,1;
2017-01-17 08:57:31.7856 DEBUG Получено записей: 175
2017-01-17 08:57:31.7856 DEBUG Запрос: Select mkb_id, mkb, kod_d, reestr_code from public.mkb_tab order by 1
2017-01-17 08:57:32.0066 DEBUG Получено записей: 13813
2017-01-17 08:57:40.5981 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-17 08:57:40.5981 DEBUG Получено записей: 11
2017-01-17 08:57:40.6261 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-17 08:57:40.6321 DEBUG Получено записей: 77
2017-01-17 08:57:40.6821 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-17 08:57:40.6821 DEBUG Получено записей: 107
2017-01-17 08:57:52.0408 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-17 08:57:52.0408 DEBUG PatientFindForm OperatorId: 2469
2017-01-17 08:57:52.0408 DEBUG PatientFindForm DoctorId: 2469
2017-01-17 08:57:55.6000 DEBUG DoctorQuery
2017-01-17 08:57:55.6000 DEBUG sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2017-01-17 08:57:55.6000 DEBUG @date: 17.01.2017
2017-01-17 08:57:55.6000 DEBUG @doctor: 2469
2017-01-17 08:57:55.6000 DEBUG bindQueryToDataGrid
2017-01-17 08:57:55.6150 DEBUG Sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2017-01-17 08:57:55.6150 DEBUG SqlParams:
2017-01-17 08:57:55.6150 DEBUG SqlParam @date='17.01.2017'
2017-01-17 08:57:55.6150 DEBUG SqlParam @doctor=2469
2017-01-17 08:58:11.9379 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam and Lower(d.nam) LIKE @nam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-17 08:58:11.9389 DEBUG SqlParams:
2017-01-17 08:58:11.9389 DEBUG SqlParam @fam=аветян%
2017-01-17 08:58:12.0139 DEBUG SqlParam @nam=мактах%
2017-01-17 08:58:20.3114 DEBUG Запрос: Select smo.id, smo.name, kladr.name from codifiers.strcom_tab smo left join codifiers.sp_kladr_tab kladr on smo.region_id = kladr.code where smo.region_id = @id and smo.name not like '*%'order by smo.name
2017-01-17 08:58:20.3844 DEBUG Получено записей: 4
2017-01-17 08:58:20.4664 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-17 08:58:20.4664 DEBUG Получено записей: 0
2017-01-17 08:58:20.4764 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-17 08:58:20.4894 DEBUG Получено записей: 0
2017-01-17 08:58:20.5384 DEBUG Запрос: SELECT t.talon_id, t.result_id, t.diag_osn, t.doctor_id, t.date_vnes_inf,
                        v.visit_id, v.doctor_id as vdoctor_id, v.data_vnes_inf as vdate_vnes_inf, v.data_pos 
                        FROM public.talon_tab t left join public.visit_tab v on v.talon_id = t.talon_id
                        where t.dan_id = @patient_id;
2017-01-17 08:58:20.6234 DEBUG Получено записей: 73
2017-01-17 08:58:21.4205 DEBUG Запрос: Select visit_id from public.visit_tab where talon_id = @talonId;
2017-01-17 08:58:21.4235 DEBUG Получено записей: 1
2017-01-17 08:58:21.4935 DEBUG Запрос: SELECT d.id FROM diagn_tab d WHERE d.talon_id = @caseId ORDER BY d.id desc;
2017-01-17 08:58:21.4935 DEBUG Получено записей: 0
2017-01-17 08:58:30.5710 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:30.6050 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:30.6250 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:30.6450 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:30.6610 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:30.6810 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:30.6960 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:30.7160 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:30.7310 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:30.7500 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:30.7650 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:30.7850 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:30.8000 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:30.8210 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:30.8750 DEBUG Запрос: select id, name from codifiers.sp_kind_paid_tab order by 1
2017-01-17 08:58:31.4940 DEBUG Запрос: select id,name from codifiers.lpu_building_tab
2017-01-17 08:58:34.0622 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-17 08:58:34.6192 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 08:58:34.6782 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 08:58:34.7772 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:34.7932 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:34.8082 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:34.8082 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:34.8382 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:34.8522 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:34.8692 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:34.8822 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:34.8982 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:34.9122 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:34.9282 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:34.9422 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:34.9582 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:34.9732 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:48.9130 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 08:58:49.0080 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:58:53.5273 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:53.5743 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:53.5913 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:54.4083 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:54.4303 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:54.4764 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:54.4934 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:54.5374 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:54.5554 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:54.5954 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:54.6124 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:54.6504 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:54.6674 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 08:58:54.7054 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 08:58:57.3695 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:58:57.4815 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:58:57.6255 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:58:57.7075 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:58:59.2246 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:58:59.2546 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:58:59.4446 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:58:59.6956 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:58:59.7217 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:58:59.9607 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:00.1857 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:00.3207 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:00.3777 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:00.6897 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:01.2567 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:01.3607 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:01.4748 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:01.6408 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:01.6658 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:01.7488 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:02.1618 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:02.2568 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:02.4438 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:02.5128 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:02.5878 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:02.6128 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:02.6378 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:02.7288 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:02.8408 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:02.8778 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:02.9528 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:06.6480 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:06.6840 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:07.4091 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:07.5211 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:07.6411 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:07.6711 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:07.8331 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:07.8581 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:08.4892 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:10.6523 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:11.1993 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:13.3924 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:13.5724 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:13.7925 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 08:59:13.9125 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:14.0165 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:16.1586 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:16.2056 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 08:59:21.2439 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:28:07.9146 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-17 09:28:07.9646 DEBUG Получено записей: 187
2017-01-17 09:28:10.2928 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2017-01-17 09:28:10.2928 DEBUG Parameters: @patterncode=, @operator=
2017-01-17 09:28:10.3218 DEBUG Result 
2017-01-17 09:28:10.3218 DEBUG нет шаблона для пользователя
2017-01-17 09:28:10.3218 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2017-01-17 09:28:10.3218 DEBUG Parameters: @patterncode 
2017-01-17 09:28:10.3348 DEBUG Result 
2017-01-17 09:28:10.3908 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2017-01-17 09:28:10.3908 DEBUG Parameters: @patterncode=, @operator=
2017-01-17 09:28:10.4038 DEBUG Result 
2017-01-17 09:28:10.4038 DEBUG нет шаблона для пользователя
2017-01-17 09:28:10.4038 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2017-01-17 09:28:10.4038 DEBUG Parameters: @patterncode 
2017-01-17 09:28:10.4148 DEBUG Result 
2017-01-17 09:28:10.8038 DEBUG Запрос: Select id, name, code, is_default, parent_id from codifiers.sp_kind_paid_tab order by id
2017-01-17 09:28:10.8038 DEBUG Получено записей: 9
2017-01-17 09:28:10.8188 DEBUG Запрос: Select id, name, code from codifiers.first_visit_condition_tab order by id
2017-01-17 09:28:10.8188 DEBUG Получено записей: 4
2017-01-17 09:28:10.8328 DEBUG Запрос: Select id, name, code, reestr, idsp, hospital_type_id, is_cure, is_inspection from codifiers.visit_purpose_common_tab order by id
2017-01-17 09:28:10.8328 DEBUG Получено записей: 22
2017-01-17 09:28:10.8508 DEBUG Запрос: Select id, name, code from codifiers.place_service_tab order by id
2017-01-17 09:28:10.8508 DEBUG Получено записей: 3
2017-01-17 09:28:10.8778 DEBUG Запрос: Select result_id, result, reestr, patient_state_id, reestr_rslt, reestr_ishod, _end from public.result_tab order by result_id
2017-01-17 09:28:10.8828 DEBUG Получено записей: 29
2017-01-17 09:28:10.8948 DEBUG Запрос: select id, name, code, bur_reestr_code from codifiers.travma_tab order by name;
2017-01-17 09:28:10.8948 DEBUG Получено записей: 15
2017-01-17 09:28:10.8948 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2017-01-17 09:28:10.9338 DEBUG Получено записей: 107
2017-01-17 09:28:11.2728 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-17 09:28:11.2858 DEBUG Получено записей: 107
2017-01-17 09:28:11.2858 DEBUG Запрос: select sp_napr_obosn_id,trim(obosn_name) as obosn_name FROM sp_napr_obosn_tab ORDER BY sp_napr_obosn_id;
2017-01-17 09:28:11.3008 DEBUG Получено записей: 8
2017-01-17 09:28:11.3008 DEBUG Запрос: SELECT sp_type_napr_id, sp_type_napr FROM sp_type_napr_tab ORDER BY 1;
2017-01-17 09:28:11.3008 DEBUG Получено записей: 9
2017-01-17 09:28:11.3248 DEBUG Запрос: select * from public.doctor_tab where sp_spec_doctor_id <> 900;
2017-01-17 09:28:11.4278 DEBUG Получено записей: 682
2017-01-17 09:28:36.4983 DEBUG Запрос: select id, code, name from codifiers.doctor_spec_tab order by 3,1;
2017-01-17 09:28:36.4983 DEBUG Получено записей: 175
2017-01-17 09:28:36.5153 DEBUG Запрос: Select mkb_id, mkb, kod_d, reestr_code from public.mkb_tab order by 1
2017-01-17 09:28:36.7123 DEBUG Получено записей: 13813
2017-01-17 09:33:04.7856 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-17 09:33:04.7856 DEBUG Получено записей: 11
2017-01-17 09:33:04.8096 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-17 09:33:04.8166 DEBUG Получено записей: 77
2017-01-17 09:33:04.8746 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-17 09:33:04.8826 DEBUG Получено записей: 107
2017-01-17 09:33:16.1493 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-17 09:33:16.1493 DEBUG PatientFindForm OperatorId: 2469
2017-01-17 09:33:16.1493 DEBUG PatientFindForm DoctorId: 2469
2017-01-17 09:33:16.2783 DEBUG DoctorQuery
2017-01-17 09:33:16.2783 DEBUG sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2017-01-17 09:33:16.2783 DEBUG @date: 17.01.2017
2017-01-17 09:33:16.2783 DEBUG @doctor: 2469
2017-01-17 09:33:16.2783 DEBUG bindQueryToDataGrid
2017-01-17 09:33:16.2923 DEBUG Sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2017-01-17 09:33:16.2923 DEBUG SqlParams:
2017-01-17 09:33:16.2923 DEBUG SqlParam @date='17.01.2017'
2017-01-17 09:33:16.2923 DEBUG SqlParam @doctor=2469
2017-01-17 09:35:01.4183 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam and Lower(d.nam) LIKE @nam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-17 09:35:01.4183 DEBUG SqlParams:
2017-01-17 09:35:01.4183 DEBUG SqlParam @fam=аветян%
2017-01-17 09:35:01.4183 DEBUG SqlParam @nam=мактах%
2017-01-17 09:35:08.5997 DEBUG Запрос: Select smo.id, smo.name, kladr.name from codifiers.strcom_tab smo left join codifiers.sp_kladr_tab kladr on smo.region_id = kladr.code where smo.region_id = @id and smo.name not like '*%'order by smo.name
2017-01-17 09:35:08.6717 DEBUG Получено записей: 4
2017-01-17 09:35:08.7377 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-17 09:35:08.7377 DEBUG Получено записей: 0
2017-01-17 09:35:08.7497 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-17 09:35:08.7607 DEBUG Получено записей: 0
2017-01-17 09:35:08.8187 DEBUG Запрос: SELECT t.talon_id, t.result_id, t.diag_osn, t.doctor_id, t.date_vnes_inf,
                        v.visit_id, v.doctor_id as vdoctor_id, v.data_vnes_inf as vdate_vnes_inf, v.data_pos 
                        FROM public.talon_tab t left join public.visit_tab v on v.talon_id = t.talon_id
                        where t.dan_id = @patient_id;
2017-01-17 09:35:08.8307 DEBUG Получено записей: 73
2017-01-17 09:35:09.6648 DEBUG Запрос: Select visit_id from public.visit_tab where talon_id = @talonId;
2017-01-17 09:35:09.6648 DEBUG Получено записей: 1
2017-01-17 09:35:09.7428 DEBUG Запрос: SELECT d.id FROM diagn_tab d WHERE d.talon_id = @caseId ORDER BY d.id desc;
2017-01-17 09:35:09.7428 DEBUG Получено записей: 0
2017-01-17 09:35:19.5313 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:19.5623 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:19.5843 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:19.6043 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:19.6203 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:19.6403 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:19.6563 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:19.6753 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:19.6903 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:19.7103 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:19.7103 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:19.7453 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:19.7613 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:19.7803 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:19.8353 DEBUG Запрос: select id, name from codifiers.sp_kind_paid_tab order by 1
2017-01-17 09:35:20.4424 DEBUG Запрос: select id,name from codifiers.lpu_building_tab
2017-01-17 09:35:23.0125 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-17 09:35:23.5806 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 09:35:23.6636 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 09:35:23.7656 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:23.7796 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:23.8016 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:23.8156 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:23.8316 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:23.8456 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:23.8616 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:23.8756 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:23.8926 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:23.8926 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:23.9326 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:23.9476 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:23.9636 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:23.9776 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:39.2955 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 09:35:44.7748 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:44.8298 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:44.8468 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:44.8908 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:45.6958 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:45.7378 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:45.7548 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:45.7958 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:45.8128 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:45.8558 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:45.8818 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:45.9228 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:45.9408 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:35:45.9798 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:35:46.0948 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:46.1429 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:46.2019 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:46.4319 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:46.5089 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:46.8879 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:47.4129 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:47.4609 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:47.8069 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:48.7910 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:48.8950 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:48.9220 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:49.0090 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:49.2230 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:35:49.3510 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:35:50.9321 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:35:51.2011 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:35:51.2621 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:35:51.3551 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:35:51.6632 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:35:51.7682 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:35:51.8792 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:35:51.9912 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:35:52.3332 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:35:52.3592 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:35:52.4552 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:52.6312 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:52.7782 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:35:54.5033 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:35:56.6475 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:36:01.6827 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:36:06.5340 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:36:06.9670 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:36:07.0710 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:36:07.3831 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:36:09.5922 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:36:37.3888 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:38.1648 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:38.8859 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:38.9899 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:39.0179 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:39.1029 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:39.3899 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:41.5040 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:41.5470 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:42.3911 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:42.4351 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:42.4511 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:42.4991 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:42.5151 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:42.5551 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:42.5721 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:42.6141 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:42.6311 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:42.6711 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:42.6881 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:42.7271 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:43.6281 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:43.6721 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:43.6931 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:43.7401 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:43.7591 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:43.8021 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:43.8201 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:43.8622 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:43.8792 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:43.9212 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:43.9392 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:43.9792 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:44.0592 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:36:44.1022 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:36:45.6223 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:45.7253 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:45.8463 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:45.8743 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:46.0063 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:46.1183 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:46.2303 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:46.3343 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:46.4813 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:36:46.8893 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:36:46.9193 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:36:46.9653 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:36:47.9344 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:36:48.6894 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:37:10.5277 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:37:12.3358 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:37:49.5379 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:49.5589 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:37:49.5739 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:49.5939 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:37:49.6089 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:49.6279 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:37:49.6439 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:49.6639 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:37:49.6779 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:49.6979 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:37:49.7119 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:49.7319 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:37:49.7469 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:49.7669 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:37:49.7969 DEBUG Запрос: select id, name from codifiers.sp_kind_paid_tab order by 1
2017-01-17 09:37:50.3510 DEBUG Запрос: select id,name from codifiers.lpu_building_tab
2017-01-17 09:37:52.9521 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-17 09:37:53.4931 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 09:37:53.5251 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 09:37:53.6181 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:53.6311 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:37:53.6461 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:53.6591 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:37:53.6761 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:53.6891 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:37:53.7051 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:53.7181 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:37:53.7361 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:53.7511 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:37:53.7672 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:53.7812 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:37:53.7962 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:37:53.8102 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:38:09.5111 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 09:38:14.7974 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:38:14.8414 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:38:15.7004 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:38:15.7424 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:38:15.7604 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:38:15.8024 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:38:15.8194 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:38:15.8624 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:38:15.8884 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:38:15.9314 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:38:15.9504 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:38:15.9914 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:38:16.0344 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:38:16.0754 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:38:16.1034 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:16.1294 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:16.1884 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:16.2194 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:16.4214 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:16.7065 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:17.1215 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:17.1855 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:17.5315 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:17.5705 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:18.4276 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:18.5316 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:18.5586 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:18.7876 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:18.8916 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:38:19.0046 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:38:19.1686 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:38:19.2596 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:38:22.5058 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:38:23.1798 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:45:25.8850 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-17 09:45:25.9340 DEBUG Получено записей: 187
2017-01-17 09:45:28.3282 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2017-01-17 09:45:28.3282 DEBUG Parameters: @patterncode=, @operator=
2017-01-17 09:45:28.3652 DEBUG Result 
2017-01-17 09:45:28.3652 DEBUG нет шаблона для пользователя
2017-01-17 09:45:28.3652 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2017-01-17 09:45:28.3652 DEBUG Parameters: @patterncode 
2017-01-17 09:45:28.3652 DEBUG Result 
2017-01-17 09:45:28.4312 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2017-01-17 09:45:28.4312 DEBUG Parameters: @patterncode=, @operator=
2017-01-17 09:45:28.4432 DEBUG Result 
2017-01-17 09:45:28.4432 DEBUG нет шаблона для пользователя
2017-01-17 09:45:28.4432 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2017-01-17 09:45:28.4432 DEBUG Parameters: @patterncode 
2017-01-17 09:45:28.4432 DEBUG Result 
2017-01-17 09:45:28.8342 DEBUG Запрос: Select id, name, code, is_default, parent_id from codifiers.sp_kind_paid_tab order by id
2017-01-17 09:45:28.8342 DEBUG Получено записей: 9
2017-01-17 09:45:28.8492 DEBUG Запрос: Select id, name, code from codifiers.first_visit_condition_tab order by id
2017-01-17 09:45:28.8492 DEBUG Получено записей: 4
2017-01-17 09:45:28.8492 DEBUG Запрос: Select id, name, code, reestr, idsp, hospital_type_id, is_cure, is_inspection from codifiers.visit_purpose_common_tab order by id
2017-01-17 09:45:28.8662 DEBUG Получено записей: 22
2017-01-17 09:45:28.8662 DEBUG Запрос: Select id, name, code from codifiers.place_service_tab order by id
2017-01-17 09:45:28.8802 DEBUG Получено записей: 3
2017-01-17 09:45:28.9042 DEBUG Запрос: Select result_id, result, reestr, patient_state_id, reestr_rslt, reestr_ishod, _end from public.result_tab order by result_id
2017-01-17 09:45:28.9042 DEBUG Получено записей: 29
2017-01-17 09:45:28.9202 DEBUG Запрос: select id, name, code, bur_reestr_code from codifiers.travma_tab order by name;
2017-01-17 09:45:28.9202 DEBUG Получено записей: 15
2017-01-17 09:45:28.9342 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2017-01-17 09:45:28.9602 DEBUG Получено записей: 107
2017-01-17 09:45:29.2982 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-17 09:45:29.3112 DEBUG Получено записей: 107
2017-01-17 09:45:29.3232 DEBUG Запрос: select sp_napr_obosn_id,trim(obosn_name) as obosn_name FROM sp_napr_obosn_tab ORDER BY sp_napr_obosn_id;
2017-01-17 09:45:29.3232 DEBUG Получено записей: 8
2017-01-17 09:45:29.3362 DEBUG Запрос: SELECT sp_type_napr_id, sp_type_napr FROM sp_type_napr_tab ORDER BY 1;
2017-01-17 09:45:29.3362 DEBUG Получено записей: 9
2017-01-17 09:45:29.3492 DEBUG Запрос: select * from public.doctor_tab where sp_spec_doctor_id <> 900;
2017-01-17 09:45:29.4482 DEBUG Получено записей: 682
2017-01-17 09:45:55.2557 DEBUG Запрос: select id, code, name from codifiers.doctor_spec_tab order by 3,1;
2017-01-17 09:45:55.2617 DEBUG Получено записей: 175
2017-01-17 09:45:55.2767 DEBUG Запрос: Select mkb_id, mkb, kod_d, reestr_code from public.mkb_tab order by 1
2017-01-17 09:45:55.4817 DEBUG Получено записей: 13813
2017-01-17 09:51:03.2393 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-17 09:51:03.2393 DEBUG Получено записей: 11
2017-01-17 09:51:03.2613 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-17 09:51:03.2673 DEBUG Получено записей: 77
2017-01-17 09:51:03.3233 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-17 09:51:03.3303 DEBUG Получено записей: 107
2017-01-17 09:52:52.1835 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-17 09:52:52.1835 DEBUG PatientFindForm OperatorId: 2469
2017-01-17 09:52:52.1835 DEBUG PatientFindForm DoctorId: 2469
2017-01-17 09:52:55.6817 DEBUG DoctorQuery
2017-01-17 09:52:55.6817 DEBUG sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2017-01-17 09:52:55.6817 DEBUG @date: 17.01.2017
2017-01-17 09:52:55.6817 DEBUG @doctor: 2469
2017-01-17 09:52:55.6817 DEBUG bindQueryToDataGrid
2017-01-17 09:52:55.6967 DEBUG Sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2017-01-17 09:52:55.6967 DEBUG SqlParams:
2017-01-17 09:52:55.6967 DEBUG SqlParam @date='17.01.2017'
2017-01-17 09:52:55.6967 DEBUG SqlParam @doctor=2469
2017-01-17 09:53:14.5768 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam and Lower(d.nam) LIKE @nam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-17 09:53:14.5768 DEBUG SqlParams:
2017-01-17 09:53:14.5768 DEBUG SqlParam @fam=аветян%
2017-01-17 09:53:14.5768 DEBUG SqlParam @nam=мактах%
2017-01-17 09:53:57.0012 DEBUG Запрос: Select smo.id, smo.name, kladr.name from codifiers.strcom_tab smo left join codifiers.sp_kladr_tab kladr on smo.region_id = kladr.code where smo.region_id = @id and smo.name not like '*%'order by smo.name
2017-01-17 09:53:57.0732 DEBUG Получено записей: 4
2017-01-17 09:53:57.1393 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-17 09:53:57.1393 DEBUG Получено записей: 0
2017-01-17 09:53:57.1503 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-17 09:53:57.1623 DEBUG Получено записей: 0
2017-01-17 09:53:57.2133 DEBUG Запрос: SELECT t.talon_id, t.result_id, t.diag_osn, t.doctor_id, t.date_vnes_inf,
                        v.visit_id, v.doctor_id as vdoctor_id, v.data_vnes_inf as vdate_vnes_inf, v.data_pos 
                        FROM public.talon_tab t left join public.visit_tab v on v.talon_id = t.talon_id
                        where t.dan_id = @patient_id;
2017-01-17 09:53:57.2243 DEBUG Получено записей: 73
2017-01-17 09:53:58.0393 DEBUG Запрос: Select visit_id from public.visit_tab where talon_id = @talonId;
2017-01-17 09:53:58.0393 DEBUG Получено записей: 1
2017-01-17 09:53:58.1163 DEBUG Запрос: SELECT d.id FROM diagn_tab d WHERE d.talon_id = @caseId ORDER BY d.id desc;
2017-01-17 09:53:58.1163 DEBUG Получено записей: 0
2017-01-17 09:54:20.1656 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:20.1956 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:20.2136 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:20.2326 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:20.2456 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:20.2686 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:20.2806 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:20.2996 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:20.3126 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:20.3316 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:20.3456 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:20.3646 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:20.3776 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:20.3966 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:20.4396 DEBUG Запрос: select id, name from codifiers.sp_kind_paid_tab order by 1
2017-01-17 09:54:21.0836 DEBUG Запрос: select id,name from codifiers.lpu_building_tab
2017-01-17 09:54:23.7268 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-17 09:54:24.3108 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 09:54:24.3618 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 09:54:24.4698 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:24.4828 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:24.4968 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:24.5088 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:24.5088 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:24.5438 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:24.5588 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:24.5718 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:24.5868 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:24.5868 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:24.6158 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:24.6288 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:24.6448 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:24.6598 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:36.5915 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 09:54:42.2508 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:42.3018 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:43.1469 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:43.1899 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:43.2069 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:43.2479 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:43.2649 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:43.3109 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:43.3359 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:43.3809 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:43.3999 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:43.4419 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:43.4589 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 09:54:43.5009 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 09:54:43.5909 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:43.6569 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:43.7199 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:43.9549 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:44.2369 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:44.3100 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:44.7020 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:45.2150 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:45.6850 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:45.8800 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:45.9840 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:46.0631 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:46.0961 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:46.3671 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:46.4651 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:54:46.6641 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:55:21.0821 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-17 09:55:43.8374 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:55:46.1495 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:55:46.3065 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:55:49.6937 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:55:51.3418 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:55:55.4540 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:55:55.8350 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:55:56.8701 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 09:55:57.0461 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 10:57:27.3082 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-17 10:57:27.3612 DEBUG Получено записей: 1
2017-01-17 10:57:29.8003 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2017-01-17 10:57:29.8003 DEBUG Parameters: @patterncode=, @operator=
2017-01-17 10:57:29.8413 DEBUG Result 
2017-01-17 10:57:29.8413 DEBUG нет шаблона для пользователя
2017-01-17 10:57:29.8413 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2017-01-17 10:57:29.8413 DEBUG Parameters: @patterncode 
2017-01-17 10:57:29.8573 DEBUG Result 
2017-01-17 10:57:29.9113 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2017-01-17 10:57:29.9113 DEBUG Parameters: @patterncode=, @operator=
2017-01-17 10:57:29.9243 DEBUG Result 
2017-01-17 10:57:29.9243 DEBUG нет шаблона для пользователя
2017-01-17 10:57:29.9243 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2017-01-17 10:57:29.9243 DEBUG Parameters: @patterncode 
2017-01-17 10:57:29.9373 DEBUG Result 
2017-01-17 10:57:30.3264 DEBUG Запрос: Select id, name, code, is_default, parent_id from codifiers.sp_kind_paid_tab order by id
2017-01-17 10:57:30.3264 DEBUG Получено записей: 9
2017-01-17 10:57:30.3424 DEBUG Запрос: Select id, name, code from codifiers.first_visit_condition_tab order by id
2017-01-17 10:57:30.3424 DEBUG Получено записей: 4
2017-01-17 10:57:30.3574 DEBUG Запрос: Select id, name, code, reestr, idsp, hospital_type_id, is_cure, is_inspection from codifiers.visit_purpose_common_tab order by id
2017-01-17 10:57:30.3924 DEBUG Получено записей: 22
2017-01-17 10:57:30.4074 DEBUG Запрос: Select id, name, code from codifiers.place_service_tab order by id
2017-01-17 10:57:30.4074 DEBUG Получено записей: 3
2017-01-17 10:57:30.4254 DEBUG Запрос: Select result_id, result, reestr, patient_state_id, reestr_rslt, reestr_ishod, _end from public.result_tab order by result_id
2017-01-17 10:57:30.4254 DEBUG Получено записей: 29
2017-01-17 10:57:30.4484 DEBUG Запрос: select id, name, code, bur_reestr_code from codifiers.travma_tab order by name;
2017-01-17 10:57:30.4664 DEBUG Получено записей: 15
2017-01-17 10:57:30.4814 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2017-01-17 10:57:30.5084 DEBUG Получено записей: 102
2017-01-17 10:57:30.8594 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-17 10:57:30.8714 DEBUG Получено записей: 102
2017-01-17 10:57:30.8714 DEBUG Запрос: select sp_napr_obosn_id,trim(obosn_name) as obosn_name FROM sp_napr_obosn_tab ORDER BY sp_napr_obosn_id;
2017-01-17 10:59:04.5757 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-17 10:59:04.6297 DEBUG Получено записей: 1
2017-01-17 10:59:11.1271 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-17 10:59:11.1331 DEBUG Получено записей: 11
2017-01-17 10:59:11.1331 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-17 10:59:11.1521 DEBUG Получено записей: 75
2017-01-17 10:59:11.1911 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-17 10:59:11.1961 DEBUG Получено записей: 0
2017-01-17 10:59:20.8007 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-17 10:59:20.8007 DEBUG PatientFindForm OperatorId: 2470
2017-01-17 10:59:20.8007 DEBUG PatientFindForm DoctorId: -1
2017-01-17 10:59:24.7689 DEBUG _loggedOperator.DoctorId==-1
2017-01-17 10:59:24.7929 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-17 10:59:24.7999 DEBUG Получено записей: 1
2017-01-17 10:59:24.8359 DEBUG _loggedOperator.DoctorId:-1
2017-01-17 10:59:42.5589 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-17 10:59:42.5589 DEBUG SqlParams:
2017-01-17 10:59:42.5589 DEBUG SqlParam @fam=иванов%
2017-01-17 10:59:51.7914 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-17 10:59:51.7914 DEBUG Получено записей: 0
2017-01-17 10:59:51.8024 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-17 10:59:51.8024 DEBUG Получено записей: 0
2017-01-17 11:00:07.8224 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:00:07.9284 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:00:07.9554 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:00:07.9694 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:00:07.9854 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:00:08.0194 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:00:08.0494 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:00:11.7086 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:00:11.7246 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:00:11.7246 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:00:11.7556 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:00:11.7556 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:00:17.8979 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:00:17.9119 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:00:17.9639 DEBUG Запрос: select id, name from codifiers.sp_kind_paid_tab order by 1
2017-01-17 11:00:18.5390 DEBUG Запрос: select id,name from codifiers.lpu_building_tab
2017-01-17 11:00:19.1980 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-17 11:00:19.7940 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 11:00:45.1955 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:00:53.2350 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:00:53.5940 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:00:53.6750 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:00:55.1031 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:00:55.1351 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:00:55.2571 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:01:03.3365 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                             order by 2
2017-01-17 11:01:43.9339 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.dan_id = dan.dan_id
                             where doc.expiration_date>@ExpDate  order by 2
2017-01-17 11:03:28.5748 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-17 11:03:28.5968 DEBUG Получено записей: 102
2017-01-17 11:03:28.6689 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-17 11:03:28.7029 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-17 11:03:28.7109 DEBUG Получено записей: 75
2017-01-17 11:05:08.9946 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.dan_id = dan.dan_id
                             where doc.expiration_date>@ExpDate  order by 2
2017-01-17 11:05:28.3007 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-17 11:05:28.3127 DEBUG Получено записей: 102
2017-01-17 11:05:32.9490 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-17 11:05:58.8234 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-17 11:05:58.8234 DEBUG SqlParams:
2017-01-17 11:05:58.8234 DEBUG SqlParam @fam=сет%
2017-01-17 11:07:52.4929 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.dan_id = dan.dan_id
                             where doc.expiration_date>@ExpDate  order by 2
2017-01-17 11:09:13.4486 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-17 11:09:13.4956 DEBUG Получено записей: 1
2017-01-17 11:09:19.4959 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-17 11:09:19.4959 DEBUG Получено записей: 11
2017-01-17 11:09:19.5109 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-17 11:09:19.5109 DEBUG Получено записей: 75
2017-01-17 11:09:19.5649 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-17 11:09:19.5689 DEBUG Получено записей: 0
2017-01-17 11:09:28.4304 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-17 11:09:28.4304 DEBUG PatientFindForm OperatorId: 403001
2017-01-17 11:09:28.4304 DEBUG PatientFindForm DoctorId: -1
2017-01-17 11:09:28.9835 DEBUG _loggedOperator.DoctorId==-1
2017-01-17 11:09:32.3096 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-17 11:09:32.3166 DEBUG Получено записей: 1
2017-01-17 11:09:32.3517 DEBUG _loggedOperator.DoctorId:-1
2017-01-17 11:09:45.7054 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-17 11:09:45.7054 DEBUG SqlParams:
2017-01-17 11:09:45.7054 DEBUG SqlParam @fam=иванов%
2017-01-17 11:09:53.8509 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-17 11:09:53.8509 DEBUG Получено записей: 0
2017-01-17 11:09:53.8619 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-17 11:09:53.8619 DEBUG Получено записей: 0
2017-01-17 11:10:42.6587 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:10:42.7387 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:10:42.7677 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:10:42.7807 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:10:42.7957 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:10:42.7957 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:10:42.8227 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:10:42.8357 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:10:42.8487 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:10:42.8597 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:10:42.8747 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:10:42.8747 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:10:42.9037 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:10:43.0147 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:10:47.1079 DEBUG Запрос: select id, name from codifiers.sp_kind_paid_tab order by 1
2017-01-17 11:10:50.2301 DEBUG Запрос: select id,name from codifiers.lpu_building_tab
2017-01-17 11:10:50.8601 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-17 11:10:51.5832 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 11:11:08.1561 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:11:08.1711 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:11:08.1931 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:11:08.2231 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:11:09.1022 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:11:09.1162 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:11:09.1332 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:11:09.1462 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:11:09.1632 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:11:09.1772 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:11:09.1942 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:11:09.2082 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:11:09.2242 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 11:11:09.2382 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 11:11:13.9715 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:14.1995 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:14.4635 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:14.6025 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:15.0155 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:16.4956 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:16.7856 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:16.9666 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:17.0786 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:17.2387 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:17.5587 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:17.6707 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:17.7827 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:18.0257 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:18.1267 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:18.3267 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:18.5987 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:18.7117 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:18.8387 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:19.0648 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:19.3328 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:19.4148 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:19.8358 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:19.8708 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:19.9428 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:20.1098 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:20.1748 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:20.3038 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:20.4228 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:20.6578 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:20.9519 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:20.9739 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:21.1829 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:21.3849 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:21.4879 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:21.9679 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:22.1619 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 11:11:22.4619 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:15:01.8743 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-17 13:15:01.9313 DEBUG Получено записей: 1
2017-01-17 13:15:08.1847 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-17 13:15:08.2947 DEBUG Получено записей: 11
2017-01-17 13:15:08.3147 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-17 13:15:08.3217 DEBUG Получено записей: 75
2017-01-17 13:15:08.3727 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-17 13:15:08.3797 DEBUG Получено записей: 0
2017-01-17 13:15:18.9603 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-17 13:15:18.9603 DEBUG PatientFindForm OperatorId: 2470
2017-01-17 13:15:18.9603 DEBUG PatientFindForm DoctorId: -1
2017-01-17 13:15:19.4403 DEBUG _loggedOperator.DoctorId==-1
2017-01-17 13:15:19.4603 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-17 13:15:19.4603 DEBUG Получено записей: 1
2017-01-17 13:15:23.0095 DEBUG _loggedOperator.DoctorId:-1
2017-01-17 13:15:37.1293 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-17 13:15:37.1293 DEBUG SqlParams:
2017-01-17 13:15:37.1293 DEBUG SqlParam @fam=раднаев%
2017-01-17 13:15:45.7028 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-17 13:15:45.7028 DEBUG Получено записей: 0
2017-01-17 13:15:45.7178 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-17 13:15:45.7178 DEBUG Получено записей: 0
2017-01-17 13:20:29.0910 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-17 13:20:29.0910 DEBUG PatientFindForm OperatorId: 2470
2017-01-17 13:20:29.0910 DEBUG PatientFindForm DoctorId: -1
2017-01-17 13:20:29.1890 DEBUG _loggedOperator.DoctorId==-1
2017-01-17 13:20:32.6122 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-17 13:20:32.6682 DEBUG Получено записей: 1
2017-01-17 13:20:32.7042 DEBUG _loggedOperator.DoctorId:-1
2017-01-17 13:20:46.6340 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-17 13:20:46.6340 DEBUG SqlParams:
2017-01-17 13:20:46.6350 DEBUG SqlParam @fam=сет%
2017-01-17 13:20:53.5394 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-17 13:20:53.5394 DEBUG Получено записей: 0
2017-01-17 13:20:53.5524 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-17 13:20:53.5524 DEBUG Получено записей: 0
2017-01-17 13:27:30.1011 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-17 13:27:30.1481 DEBUG Получено записей: 1
2017-01-17 13:27:37.0175 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-17 13:27:37.0175 DEBUG Получено записей: 11
2017-01-17 13:27:37.0325 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-17 13:27:37.0325 DEBUG Получено записей: 75
2017-01-17 13:27:37.0915 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-17 13:27:37.0915 DEBUG Получено записей: 0
2017-01-17 13:27:45.9700 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-17 13:27:45.9700 DEBUG PatientFindForm OperatorId: 2470
2017-01-17 13:27:45.9700 DEBUG PatientFindForm DoctorId: -1
2017-01-17 13:27:46.5561 DEBUG _loggedOperator.DoctorId==-1
2017-01-17 13:27:49.9682 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-17 13:27:49.9762 DEBUG Получено записей: 1
2017-01-17 13:27:50.0113 DEBUG _loggedOperator.DoctorId:-1
2017-01-17 13:28:07.3272 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-17 13:28:07.3272 DEBUG SqlParams:
2017-01-17 13:28:07.3272 DEBUG SqlParam @fam=сет%
2017-01-17 13:28:15.5597 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-17 13:28:15.5597 DEBUG Получено записей: 0
2017-01-17 13:28:15.5597 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-17 13:28:15.5747 DEBUG Получено записей: 0
2017-01-17 13:29:33.4172 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:33.5162 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:33.5392 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:33.5522 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:33.5682 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:33.5812 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:33.5972 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:33.6102 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:33.6272 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:33.6402 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:37.2864 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:37.2984 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:37.3134 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:37.3254 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:40.9566 DEBUG Запрос: select id, name from codifiers.sp_kind_paid_tab order by 1
2017-01-17 13:29:41.8846 DEBUG Запрос: select id,name from codifiers.lpu_building_tab
2017-01-17 13:29:42.5597 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-17 13:29:43.1127 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-17 13:29:54.5064 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:54.5204 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:55.3154 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:55.3314 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:55.3494 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:55.3634 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:55.3804 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:55.3944 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:55.4124 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:55.4264 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:55.4434 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:55.4584 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:55.4944 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-17 13:29:55.5094 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2017-01-17 13:29:55.5534 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:29:55.5934 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:29:55.6274 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:29:55.6614 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:29:55.6974 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:29:56.0395 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:29:56.0785 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:29:56.1145 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:29:56.9555 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:29:57.9206 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:29:57.9446 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:29:58.6216 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:29:58.7656 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:00.3407 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:00.6857 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:00.8307 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:01.0537 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:01.1658 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:01.3578 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:01.4698 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:01.7018 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:01.7738 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:02.2938 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:02.3988 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:02.5018 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:02.6618 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:02.8528 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:03.1549 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:03.6379 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2017-01-17 13:30:06.4451 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
