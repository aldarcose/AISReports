2016-12-20 00:10:27.4846 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:27.5927 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:27.7127 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:27.8077 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:27.8577 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:29.1137 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:30.2178 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:30.3288 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:31.7649 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:31.7979 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:32.1569 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:32.2629 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:32.3249 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:32.3759 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:32.4009 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:32.5109 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:32.5399 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:32.5639 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:32.6639 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:32.7439 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:33.0640 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:33.1670 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:33.3030 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:33.4080 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:33.5420 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:33.6560 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:33.6810 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:33.7900 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:33.8130 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:33.9030 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:34.0160 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:34.2240 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:34.3300 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:34.3550 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:34.4310 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:34.4550 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:34.4890 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:34.6321 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:34.6561 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:34.7581 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:34.7871 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:34.9431 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:35.0871 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:35.2801 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:35.9251 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:36.0241 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:36.1201 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:36.3432 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:36.4962 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:36.5832 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:36.6542 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:36.6882 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:36.7902 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:36.8202 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:36.9062 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:36.9322 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:37.0152 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:37.1532 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:37.3202 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:37.5452 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:37.6552 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:37.7592 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:37.7852 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:37.8722 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:37.9842 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:38.0152 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:38.0963 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:38.1273 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:38.1743 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:38.3193 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:38.4473 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:38.5603 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:38.5843 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:38.7203 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:39.0483 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:39.1533 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:39.1793 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:39.3113 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:39.4243 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:39.5283 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:39.5643 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:39.8484 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:39.8744 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:39.9204 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:40.0574 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:40.1524 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:40.2654 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:40.3754 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:40.4884 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:40.5924 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:40.7044 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:40.8064 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:41.0164 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:41.1834 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:41.4074 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:41.5204 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:41.5474 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:41.6235 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:41.6555 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:41.8465 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:42.0635 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:42.4305 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:42.5435 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:42.5665 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:42.6225 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:42.7265 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:42.8005 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:42.8235 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:42.9355 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:43.0485 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:43.1575 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:43.2785 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:43.3075 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:43.3906 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:43.6166 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:43.7746 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:43.8876 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:44.2626 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:44.3836 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:44.4786 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:44.6406 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:44.7436 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:45.0566 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:45.1667 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:45.2877 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:45.3917 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:45.5227 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:45.5467 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:45.6557 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:45.6867 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:45.7987 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:46.0397 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:46.5037 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:46.6087 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:46.7377 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:46.7617 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:47.0548 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:47.5328 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:47.6398 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:47.7438 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:47.8728 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:47.9118 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:48.0878 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:48.2628 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:48.6239 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:48.7369 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:48.8649 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:48.8939 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:49.1539 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:49.2709 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:49.3759 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:49.4039 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:49.4809 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:49.5909 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:49.6149 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:49.7499 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:49.8069 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:49.9509 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:50.0629 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:50.4720 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:50.6070 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:50.8070 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:50.9200 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:51.0560 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:51.1600 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:51.2640 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:51.3830 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:51.4070 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:51.5050 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:51.6300 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:51.7670 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:52.0320 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:52.2641 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:52.3741 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:52.4801 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:52.6191 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:52.6481 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:52.7761 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:52.8881 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:53.0001 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:53.1281 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:53.2401 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:53.4811 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:53.9602 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:54.0642 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:54.1672 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:54.1912 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:54.2802 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:54.3112 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:54.3922 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:54.4172 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:54.5362 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:54.6392 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:54.6722 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:54.7522 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:54.7772 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:54.8782 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:55.0322 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:55.1442 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:55.1692 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:55.2742 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:55.2972 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:55.5332 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:56.0083 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:56.1833 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:56.6113 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:56.8323 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:56.9363 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:57.0623 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:57.0873 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:57.1113 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:57.1523 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:57.2803 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:57.4064 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:57.5114 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:57.5404 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:57.6324 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:57.7364 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:57.7604 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:57.8404 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:58.0404 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:58.1574 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:58.2644 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:58.3884 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:58.4144 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:58.4794 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:58.5174 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:58.6554 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:58.7744 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:58.7974 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:58.8954 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:59.0004 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:59.1285 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:59.2245 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:59.3475 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:59.4465 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:59.5585 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:10:59.7775 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:10:59.8005 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:00.0065 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:00.1185 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:00.2315 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:00.3475 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:00.3715 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:00.4465 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:00.5705 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:00.6015 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:00.8226 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:00.9346 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:01.0466 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:01.0716 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:01.1586 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:01.2626 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:01.5906 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:01.6146 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:01.7106 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:01.7346 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:01.8366 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:01.8606 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:02.0936 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:02.1216 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:02.2156 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:02.2426 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:02.3536 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:02.3916 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:02.5196 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:02.6247 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:02.7367 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:02.8677 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:02.8917 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:02.9847 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:03.1287 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:03.5667 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:03.6797 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:03.7757 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:03.8227 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:03.9987 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:04.0267 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:04.1037 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:04.2157 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:04.3518 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:04.3778 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:04.4588 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:04.5858 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:04.6708 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:04.7748 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:04.7988 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:04.8958 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:04.9248 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:05.0858 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:05.2238 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:05.3998 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:05.5038 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:05.6158 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:05.7198 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:05.8228 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:05.8468 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:05.9378 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:06.0469 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:06.0709 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:06.1599 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:06.3119 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:06.4159 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:06.5279 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:06.5589 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:06.6389 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:06.6639 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:06.8549 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:06.8819 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:06.9679 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:07.0959 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:07.1199 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:07.3199 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:07.4239 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:07.5289 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:07.6599 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:07.6879 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:07.7799 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:07.9370 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:08.0390 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:08.4640 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:08.6880 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:08.7120 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:08.7920 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:08.8620 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:08.8880 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:08.9990 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:09.1400 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:09.2240 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:09.3360 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:09.3710 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:09.4390 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:09.6641 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:09.9361 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:10.1501 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:10.2641 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:10.3761 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:10.4461 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:10.4791 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:10.5911 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:10.6151 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:10.7111 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:10.7361 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:10.8141 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:10.8591 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:10.9201 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:12.0912 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:11:14.1683 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:14.1983 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:14.2813 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:14.5433 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:14.7033 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:14.8324 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:14.9764 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:15.0794 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:15.1044 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:15.1844 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:15.3224 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:15.4474 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:15.7034 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:16.1114 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:16.2944 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:16.4794 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:17.1525 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:17.4865 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:17.6955 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:18.1625 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:11:18.2715 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:19.3669 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:19.3919 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:19.4709 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:19.5389 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:19.6139 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:21.3890 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:21.4460 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:21.5271 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:21.5501 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:21.5841 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:21.6301 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:23.9732 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:24.0862 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:24.1892 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:24.3142 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:24.3472 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:24.4132 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:24.5412 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:24.5672 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:24.6612 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:24.7732 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:24.9152 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:25.1583 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:25.4393 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:25.5493 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:25.5783 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:25.6613 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:25.8143 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:25.9253 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:25.9483 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:26.0443 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:26.0683 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:26.1343 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:26.2373 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:26.3583 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:26.5013 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:26.6143 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:26.7494 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:26.7984 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:26.8234 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:26.9094 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:26.9394 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:27.0224 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:27.1264 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:27.2464 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:27.2754 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:27.4374 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:27.5504 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:27.6624 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:27.7744 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:27.7994 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:27.8794 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:27.9344 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:28.0944 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:28.1184 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:28.2064 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:28.3394 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:28.3904 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:28.4875 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:28.5985 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:28.7135 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:28.8405 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:28.8665 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:28.8905 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:28.9915 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:29.0845 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:29.1745 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:29.1985 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:29.2865 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:29.3145 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:30.1455 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:30.2626 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:30.3666 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:30.3916 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:30.4696 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:30.5036 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:30.5906 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:30.6156 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:30.7226 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:31.0226 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:31.1526 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:31.5826 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:31.6946 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:31.7186 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:31.9146 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:32.0307 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:32.0557 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:32.1337 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:32.2377 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:32.3497 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:32.4587 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:32.5017 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:32.6267 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:32.6507 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:32.7427 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:32.8697 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:33.0607 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:33.0847 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:33.1417 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:33.4937 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:33.6217 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:33.7588 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:33.8458 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:33.9748 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:34.0868 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:34.1898 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:34.3008 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:34.5648 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:34.7178 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:34.9768 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:35.9349 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:36.1409 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:36.1669 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:36.2529 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:36.3659 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:36.3909 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:36.4769 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:36.6849 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:36.8389 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:36.9659 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:37.5650 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:37.7660 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:37.9750 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:38.1340 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:38.2380 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:39.1411 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:39.2881 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:39.5261 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:39.6461 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:39.6721 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:39.7761 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:39.9211 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:39.9461 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:40.0671 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:40.0951 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:40.1431 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:40.2711 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:40.3761 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:40.5661 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:40.7272 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:40.8302 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:40.9402 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:40.9652 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:41.0762 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:41.1002 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:41.2142 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:41.3182 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:41.4382 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:41.9902 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:42.0962 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:42.2062 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:42.2292 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:42.4783 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:42.5823 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:42.7373 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:42.7793 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:42.8053 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:42.8463 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:42.9593 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:43.1433 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:43.3803 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:43.5743 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:43.7823 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:43.9013 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:44.0683 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:44.1733 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:44.3024 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:44.5344 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:44.7414 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:44.8454 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:44.9574 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:44.9824 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:45.4004 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:45.5004 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:45.7144 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:45.8144 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:45.9244 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:45.9505 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:46.1145 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:46.1385 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:46.2305 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:46.3425 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:46.4645 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:46.5655 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:46.6785 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:46.7025 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:46.8065 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:47.0385 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:47.2775 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:47.4375 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:47.5495 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:47.6645 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:47.7666 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:47.8776 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:47.9906 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:48.0206 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:48.1446 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:48.3186 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:49.1446 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:56.1100 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:56.5501 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:56.5741 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:56.7701 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:56.7951 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:56.8781 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:56.9011 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:57.0121 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:57.1261 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:57.2291 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:57.4371 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:57.6061 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:57.7091 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:57.7741 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:21:57.8131 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:57.9491 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:58.0681 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:58.0931 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:58.1812 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:58.2842 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:58.3742 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:58.4922 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:58.9022 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:59.1242 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:59.2212 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:59.4392 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:59.4642 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:59.5962 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:59.7102 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:21:59.9763 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:00.0453 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:00.1003 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:00.2133 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:00.4133 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:01.3723 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:01.4683 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:01.4953 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:01.5813 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:01.6103 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:01.6954 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:01.7214 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:01.7974 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:01.9584 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:02.0534 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:02.2784 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:02.4054 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:02.5014 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:02.6134 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:02.7324 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:02.7584 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:02.8784 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:02.9904 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:03.1984 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:03.3004 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:03.4144 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:03.5175 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:03.5435 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:03.6305 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:03.7405 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:03.8525 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:03.9805 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:04.1805 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:04.2705 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:04.4555 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:04.6385 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:04.7415 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:04.8725 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:04.9265 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:05.0385 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:05.1415 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:05.2616 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:05.3746 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:05.5136 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:05.5506 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:05.6686 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:05.7656 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:05.8846 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:05.9966 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:06.0266 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:06.1346 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:06.2246 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:06.3516 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:06.4616 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:06.6936 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:06.8216 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:06.8536 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:06.9747 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:07.1747 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:07.3817 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:07.4847 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:07.5987 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:07.7097 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:07.8137 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:07.9607 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:09.2248 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:10.0608 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:10.3988 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:10.5189 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:11.6959 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:11.8219 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:11.9509 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:12.1740 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:12.3900 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:12.5900 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:12.6940 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:12.7980 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:12.9410 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:12.9810 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:13.0850 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:13.1980 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:13.2220 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:13.3080 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:13.3360 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:13.4370 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:14.0131 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:14.1331 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:14.1591 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:14.2371 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:14.2641 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:14.6061 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:14.7091 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:14.7351 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:14.8421 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:15.1401 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:15.1641 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:15.2751 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:15.3901 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:15.4841 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:15.5081 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:15.6211 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:15.8302 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:15.9422 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:16.0552 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:16.1572 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:16.2702 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:16.4052 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:16.5972 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:16.7012 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:16.9102 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:17.8933 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:18.0773 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:19.1253 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:19.2374 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:19.2624 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:19.3584 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:19.3824 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:19.4614 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:19.5734 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:19.6774 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:19.7084 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:19.7894 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:19.8934 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:20.0134 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:20.1434 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:20.3424 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:20.4374 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:20.5494 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:20.5744 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:20.6764 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:20.8064 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:20.9495 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:21.6245 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:21.7255 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:21.7505 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:21.9485 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:22.0525 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:22.1955 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:22.2745 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:22.3555 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:22.4125 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:22.6235 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:23.0526 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:23.1566 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:23.2766 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:23.4076 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:23.5336 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:23.6706 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:24.2846 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:24.3966 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:24.8557 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:24.9327 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:25.0367 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:25.1497 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:25.2607 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:25.3937 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:25.4187 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:25.5177 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:25.7737 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:25.8757 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:25.8997 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:25.9907 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:26.0147 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:26.1097 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:26.2208 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:26.3158 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:26.3858 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:26.4368 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:26.6528 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:26.7658 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:27.3088 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:27.5178 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:28.9579 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:29.0729 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:29.2859 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:29.4539 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:29.5329 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:29.6369 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:29.7410 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:29.8810 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:29.9050 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:29.9900 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:30.1400 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:30.2690 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:30.7340 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:30.9020 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:31.0050 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:31.2240 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:31.2510 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:31.4301 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:31.6781 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:31.7701 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:31.7931 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:31.8181 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:31.9761 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:32.0281 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:32.1361 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:32.1601 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:32.2771 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:32.4041 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:32.4861 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:32.5561 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:32.6601 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:32.8281 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:32.9241 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:33.0371 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:33.1542 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:33.3572 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:33.4532 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:33.4822 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:33.8462 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:33.9572 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:34.0362 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:34.2262 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:34.5572 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:34.9503 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:35.0853 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:36.6373 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:36.8944 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:36.9654 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:37.1744 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:37.2724 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:37.3814 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:37.4854 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:37.5974 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:37.6214 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:37.7334 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:37.8384 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:37.8724 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:38.1424 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:38.2924 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:38.9265 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:38.9575 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:39.0375 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:39.1135 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:39.2245 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:39.3335 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:39.4385 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:39.4635 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:39.6135 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:40.8886 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:40.9436 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:42.1227 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:42.1527 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:42.4527 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:42.5017 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:22:43.1077 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:43.2327 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:44.1398 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:44.3568 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:44.8048 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:44.8308 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:44.9368 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:45.1448 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:45.1708 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:45.2778 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:45.8369 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:47.7810 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:48.1550 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:48.3730 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:48.9011 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:49.1501 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:49.9261 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:50.0371 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:50.0621 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:50.1411 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:50.1661 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:52.3722 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:52.3963 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:52.4683 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:52.5963 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:53.9693 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:54.0693 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:54.1734 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:54.1984 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:54.2844 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:54.3074 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:54.3384 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:54.4044 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:54.4294 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:56.3965 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:56.5015 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:56.6245 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:56.6545 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:58.4866 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:58.5156 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:58.7336 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:22:58.7646 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:00.2277 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:00.3257 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:00.4437 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:00.4677 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:00.5087 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:00.5487 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:00.5747 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:00.6607 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:00.7637 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:00.8757 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:00.8987 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:01.0997 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:01.1238 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:01.5968 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:01.6228 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:01.7108 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:01.8118 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:01.8368 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:01.9248 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:01.9498 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:02.0358 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:02.0778 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:02.1408 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:02.2518 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:02.3638 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:02.4778 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:02.8929 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:03.0039 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:03.2249 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:03.2499 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:03.3319 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:03.4469 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:03.4709 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:03.6069 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:03.7109 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:04.1489 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:05.1470 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:08.6112 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:13.2194 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:13.4375 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:13.5485 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:13.6605 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:13.6875 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:13.7695 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:13.9045 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:14.1525 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:14.2615 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:14.3655 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:14.3915 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:14.4685 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:23.2670 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 00:23:23.2900 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 00:23:23.9971 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 00:23:24.0211 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 00:23:24.0371 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 00:23:24.0601 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 00:23:24.0761 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 00:23:24.0991 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 00:23:24.1171 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 00:23:24.1401 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 00:23:24.1571 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 00:23:24.1791 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 00:23:24.1951 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 00:23:24.2171 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 00:23:34.1736 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:34.2196 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:34.2846 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:34.4227 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:34.9747 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.0427 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.0927 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.1877 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.2177 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.3027 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.3277 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.4137 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.5157 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.6517 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.7067 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.7327 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.8107 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.9287 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:35.9527 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:36.0367 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:36.0597 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:36.1418 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:36.1668 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:36.2758 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:36.4448 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:36.5468 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:36.6608 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:36.6858 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:36.7638 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:36.8848 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:36.9118 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:36.9958 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:37.0618 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:37.1078 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:37.1658 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:37.2208 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:37.2438 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:37.3408 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:37.3678 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:37.4598 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:37.9699 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:38.9479 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:39.0529 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:39.1549 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:39.2679 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:39.3999 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:39.4589 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:39.6210 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:39.7550 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:40.5960 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:40.7100 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:40.7340 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:40.8200 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:40.8610 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:40.9240 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:40.9490 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:41.0360 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:41.1390 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:41.2590 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:41.2860 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:41.3571 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:41.5091 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:42.1431 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:42.4601 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:42.7351 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:42.8291 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:42.8561 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:42.9401 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:42.9651 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:43.1402 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:43.1732 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:43.3432 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:43.4682 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:43.5812 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:43.6052 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:43.6922 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:43.8042 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:43.9402 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:44.0532 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:44.1552 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:44.3842 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:44.4082 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:44.6442 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:44.6672 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:44.7552 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:45.0533 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:45.0813 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:45.1813 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:45.3253 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:45.3963 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:45.5003 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:45.5253 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:45.6133 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:45.7243 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:45.7493 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:45.7913 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:47.0414 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:48.2844 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:48.8175 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:50.0916 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:50.1156 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:50.4526 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:50.5646 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:50.6756 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:50.8126 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:50.9576 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:51.0846 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:51.1726 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:51.2926 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:51.3176 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:51.3966 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:51.4246 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:51.9247 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:52.7237 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:52.8297 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:52.8527 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:52.9417 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:53.0517 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:53.1557 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:53.2987 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:53.3407 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:53.4657 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:53.5888 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:53.7708 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:53.8928 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:53.9228 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:54.2318 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:54.6528 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:54.7468 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:54.7968 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:54.8618 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:54.9748 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:55.0838 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:55.4009 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:55.7979 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:55.9079 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:56.0199 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:56.0459 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:56.1249 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:56.2379 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:56.2609 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:56.3489 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:56.4849 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:56.5849 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:56.6089 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:56.6929 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:56.8039 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:56.9609 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:56.9919 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:23:58.2290 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:23:59.9031 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:00.6792 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:00.7962 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:00.9082 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:24:01.0472 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:24:01.1392 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:24:01.2662 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:24:01.3802 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:24:01.7632 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:24:01.8672 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:01.9322 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:02.0282 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:02.0582 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:02.1642 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:02.3723 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:02.4833 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:24:02.5883 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:24:02.6203 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:24:02.7403 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:24:02.8443 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:24:02.9783 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:03.1013 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:03.1803 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:03.3813 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:03.4833 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:03.5963 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 00:24:03.7093 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:03.8123 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 00:24:03.9243 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 13:53:03.3446 DEBUG Запрос: SELECT DISTINCT code_access, name, description FROM users_access_view WHERE users_id = @id
2016-12-20 13:53:03.3936 DEBUG Получено записей: 187
2016-12-20 13:53:05.6468 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2016-12-20 13:53:05.6468 DEBUG Parameters: @patterncode=, @operator=
2016-12-20 13:53:05.6888 DEBUG Result 
2016-12-20 13:53:05.6888 DEBUG нет шаблона для пользователя
2016-12-20 13:53:05.6888 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2016-12-20 13:53:05.6888 DEBUG Parameters: @patterncode 
2016-12-20 13:53:05.7028 DEBUG Result 
2016-12-20 13:53:05.7588 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2016-12-20 13:53:05.7588 DEBUG Parameters: @patterncode=, @operator=
2016-12-20 13:53:05.7588 DEBUG Result 
2016-12-20 13:53:05.7588 DEBUG нет шаблона для пользователя
2016-12-20 13:53:05.7588 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2016-12-20 13:53:05.7588 DEBUG Parameters: @patterncode 
2016-12-20 13:53:05.7838 DEBUG Result 
2016-12-20 13:53:06.1298 DEBUG Запрос: Select id, name, code, is_default, parent_id from codifiers.sp_kind_paid_tab order by id
2016-12-20 13:53:06.1298 DEBUG Получено записей: 9
2016-12-20 13:53:06.1418 DEBUG Запрос: Select id, name, code from codifiers.first_visit_condition_tab order by id
2016-12-20 13:53:06.1418 DEBUG Получено записей: 4
2016-12-20 13:53:06.1548 DEBUG Запрос: Select id, name, code, reestr, idsp, hospital_type_id, is_cure, is_inspection from codifiers.visit_purpose_common_tab order by id
2016-12-20 13:53:06.1548 DEBUG Получено записей: 22
2016-12-20 13:53:06.1708 DEBUG Запрос: Select id, name, code from codifiers.place_service_tab order by id
2016-12-20 13:53:06.1708 DEBUG Получено записей: 3
2016-12-20 13:53:06.1838 DEBUG Запрос: Select result_id, result, reestr, patient_state_id, reestr_rslt, reestr_ishod, _end from public.result_tab order by result_id
2016-12-20 13:53:06.1838 DEBUG Получено записей: 29
2016-12-20 13:53:06.2008 DEBUG Запрос: select id, name, code, bur_reestr_code from codifiers.travma_tab order by name;
2016-12-20 13:53:06.2178 DEBUG Получено записей: 15
2016-12-20 13:53:06.2298 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2016-12-20 13:53:06.2548 DEBUG Получено записей: 105
2016-12-20 13:53:06.5808 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2016-12-20 13:53:06.5908 DEBUG Получено записей: 105
2016-12-20 13:53:06.6018 DEBUG Запрос: select sp_napr_obosn_id,trim(obosn_name) as obosn_name FROM sp_napr_obosn_tab ORDER BY sp_napr_obosn_id;
2016-12-20 13:53:06.6018 DEBUG Получено записей: 8
2016-12-20 13:53:06.6018 DEBUG Запрос: SELECT sp_type_napr_id, sp_type_napr FROM sp_type_napr_tab ORDER BY 1;
2016-12-20 13:53:06.6178 DEBUG Получено записей: 9
2016-12-20 13:53:06.6178 DEBUG Запрос: select * from public.doctor_tab where sp_spec_doctor_id <> 900;
2016-12-20 13:53:06.7278 DEBUG Получено записей: 672
2016-12-20 13:53:36.7956 DEBUG Запрос: select id, code, name from codifiers.doctor_spec_tab order by 3,1;
2016-12-20 13:53:36.7956 DEBUG Получено записей: 175
2016-12-20 13:53:36.8146 DEBUG Запрос: Select mkb_id, mkb, kod_d, reestr_code from public.mkb_tab order by 1
2016-12-20 13:53:37.0036 DEBUG Получено записей: 13813
2016-12-20 13:54:02.1370 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2016-12-20 13:54:02.1390 DEBUG Получено записей: 11
2016-12-20 13:54:02.1390 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2016-12-20 13:54:02.1610 DEBUG Получено записей: 77
2016-12-20 13:54:02.2200 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2016-12-20 13:54:02.2200 DEBUG Получено записей: 107
2016-12-20 13:56:39.1440 DEBUG PatientFindForm ShowFilterByDoctor set to true
2016-12-20 13:56:39.1730 DEBUG PatientFindForm OperatorId: 2469
2016-12-20 13:56:39.1730 DEBUG PatientFindForm DoctorId: 2469
2016-12-20 13:56:39.3070 DEBUG DoctorQuery
2016-12-20 13:56:39.3070 DEBUG sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2016-12-20 13:56:39.3070 DEBUG @date: 20.12.2016
2016-12-20 13:56:39.3090 DEBUG @doctor: 2469
2016-12-20 13:56:39.3090 DEBUG bindQueryToDataGrid
2016-12-20 13:56:39.3090 DEBUG Sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2016-12-20 13:56:39.3090 DEBUG SqlParams:
2016-12-20 13:56:39.3090 DEBUG SqlParam @date='20.12.2016'
2016-12-20 13:56:39.3090 DEBUG SqlParam @doctor=2469
2016-12-20 13:56:57.1090 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam and Lower(d.nam) LIKE @nam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2016-12-20 13:56:57.1090 DEBUG SqlParams:
2016-12-20 13:56:57.1090 DEBUG SqlParam @fam=аветян%
2016-12-20 13:56:57.1090 DEBUG SqlParam @nam=мактах%
2016-12-20 13:57:14.6760 DEBUG Запрос: Select smo.id, smo.name, kladr.name from codifiers.strcom_tab smo left join codifiers.sp_kladr_tab kladr on smo.region_id = kladr.code where smo.region_id = @id and smo.name not like '*%'order by smo.name
2016-12-20 13:57:14.7530 DEBUG Получено записей: 4
2016-12-20 13:57:14.8290 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2016-12-20 13:57:14.8330 DEBUG Получено записей: 0
2016-12-20 13:57:14.8330 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2016-12-20 13:57:14.8570 DEBUG Получено записей: 0
2016-12-20 13:57:14.9120 DEBUG Запрос: SELECT t.talon_id, t.result_id, t.diag_osn, t.doctor_id, t.date_vnes_inf,
                        v.visit_id, v.doctor_id as vdoctor_id, v.data_vnes_inf as vdate_vnes_inf, v.data_pos 
                        FROM public.talon_tab t left join public.visit_tab v on v.talon_id = t.talon_id
                        where t.dan_id = @patient_id;
2016-12-20 13:57:15.0400 DEBUG Получено записей: 73
2016-12-20 13:57:15.8911 DEBUG Запрос: Select visit_id from public.visit_tab where talon_id = @talonId;
2016-12-20 13:57:15.8911 DEBUG Получено записей: 0
2016-12-20 13:57:15.9231 DEBUG Запрос: SELECT d.id FROM diagn_tab d WHERE d.talon_id = @caseId ORDER BY d.id desc;
2016-12-20 13:57:15.9231 DEBUG Получено записей: 0
2016-12-20 13:57:20.6594 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:20.6994 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 13:57:20.7234 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:20.7454 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 13:57:20.7604 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:20.7824 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 13:57:20.7984 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:20.8184 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 13:57:20.8334 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:20.8554 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 13:57:20.8704 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:20.8914 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 13:57:20.9094 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:20.9314 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 13:57:20.9864 DEBUG Запрос: select id, name from codifiers.sp_kind_paid_tab order by 1
2016-12-20 13:57:21.7004 DEBUG Запрос: select id,name from codifiers.lpu_building_tab
2016-12-20 13:57:24.2186 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2016-12-20 13:57:27.5057 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2016-12-20 13:57:27.6268 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2016-12-20 13:57:27.7228 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:27.7368 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 13:57:27.7538 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:27.7708 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 13:57:27.7868 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:27.7998 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 13:57:27.8148 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:27.8278 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 13:57:27.8438 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:27.8598 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 13:57:27.8768 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:27.8918 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 13:57:27.9168 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 13:57:27.9318 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:12:50.8476 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2016-12-20 14:12:56.1659 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:12:56.1969 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:12:56.2149 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:12:56.2399 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:12:56.6339 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:12:56.6599 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:12:56.6779 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:12:56.7039 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:12:56.7219 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:12:56.7479 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:12:56.7649 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:12:56.7909 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:12:56.8089 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:12:56.8339 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:12:58.4460 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:00.2641 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:00.2901 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:00.3061 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:00.3301 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:00.7261 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:00.7501 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:00.7681 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:00.7941 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:00.8111 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:00.8361 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:00.8551 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:00.8791 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:00.8961 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:00.9201 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:01.4302 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:01.4582 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:01.4752 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:01.5022 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:01.5222 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:01.5492 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:01.5662 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:01.5912 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:01.6092 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:01.6382 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:01.6572 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:01.6942 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:01.7132 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 14:13:01.7412 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 14:13:03.3033 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:03.4303 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:03.5803 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:03.6633 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:04.9434 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:05.0464 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:05.2634 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:05.4234 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:05.5584 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:05.6544 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:05.7664 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:05.8784 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:05.9094 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:05.9824 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:06.0164 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:06.1024 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:06.1274 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:06.1584 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:06.2064 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:06.4455 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:06.4805 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:06.5435 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:06.6545 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:06.7665 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:06.8955 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:06.9985 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:07.1485 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:07.2235 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:07.3265 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:07.7175 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:07.9825 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:08.0865 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:08.2226 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:08.2486 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:08.3956 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:08.5076 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:08.8466 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:08.9516 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:09.0546 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:09.1746 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:09.2816 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:09.5226 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:09.6316 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:09.7586 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:09.7916 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:09.8786 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:10.0867 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:10.2667 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:10.3027 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:10.4367 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:10.5357 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:10.5627 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:10.6547 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:10.6847 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:10.7587 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:10.7867 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:10.8887 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:11.0227 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:11.2077 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:11.2547 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:11.3667 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:11.3957 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:11.5497 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:11.6708 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:11.8388 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:11.9508 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:12.0548 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:12.1668 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:12.1988 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:12.4148 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:12.5268 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:12.6308 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:12.7508 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:12.8848 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:12.9098 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:12.9828 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:13.0918 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:13.1928 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:13.3158 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:13.4068 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:13.5259 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:13.6389 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:13.7499 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:13.8629 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:13.9749 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:14.0779 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:14.2149 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:14.2539 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:14.5899 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:14.6869 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:14.7799 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:14.8059 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:15.1590 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:15.2700 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:15.3750 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:15.5020 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:15.6060 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:15.7430 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:16.3690 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:16.4940 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:16.5260 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:16.8950 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:16.9261 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:17.0151 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:17.1261 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:17.2311 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:17.3641 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:17.5021 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:17.6761 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:17.9261 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:18.0701 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:18.2961 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:18.3981 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:18.5751 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:18.8222 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:18.8542 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:18.9762 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:19.0702 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:19.1822 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:19.2942 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:19.3982 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:19.4312 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:19.5982 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:19.7112 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:19.8302 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:19.9342 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:20.0662 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:20.2542 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:20.3592 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:20.4703 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:20.5753 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:20.6753 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:20.7063 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:20.9903 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:21.1823 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:21.2863 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:21.3153 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:21.4063 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:21.4373 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:21.5503 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:21.6633 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:21.8143 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:21.9663 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:22.2064 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:22.3264 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:22.6624 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:22.7664 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:22.8864 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:22.9264 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:24.3115 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:24.3445 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:24.4065 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:24.6455 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:24.8385 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:25.0975 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:26.4626 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:26.5596 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:26.6696 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:26.7826 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:26.8706 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:26.9576 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:27.0866 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:27.1826 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:13:27.2946 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 14:38:39.3661 DEBUG Запрос: SELECT DISTINCT code_access, name, description FROM users_access_view WHERE users_id = @id
2016-12-20 14:38:39.4171 DEBUG Получено записей: 187
2016-12-20 14:38:41.6073 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2016-12-20 14:38:41.6073 DEBUG Parameters: @patterncode=, @operator=
2016-12-20 14:38:41.6503 DEBUG Result 
2016-12-20 14:38:41.6503 DEBUG нет шаблона для пользователя
2016-12-20 14:38:41.6503 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2016-12-20 14:38:41.6503 DEBUG Parameters: @patterncode 
2016-12-20 14:38:41.6643 DEBUG Result 
2016-12-20 14:38:41.7223 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2016-12-20 14:38:41.7223 DEBUG Parameters: @patterncode=, @operator=
2016-12-20 14:38:41.7223 DEBUG Result 
2016-12-20 14:38:41.7223 DEBUG нет шаблона для пользователя
2016-12-20 14:38:41.7223 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2016-12-20 14:38:41.7223 DEBUG Parameters: @patterncode 
2016-12-20 14:38:41.7483 DEBUG Result 
2016-12-20 14:38:42.1453 DEBUG Запрос: Select id, name, code, is_default, parent_id from codifiers.sp_kind_paid_tab order by id
2016-12-20 14:38:42.1453 DEBUG Получено записей: 9
2016-12-20 14:38:42.1593 DEBUG Запрос: Select id, name, code from codifiers.first_visit_condition_tab order by id
2016-12-20 14:38:42.1593 DEBUG Получено записей: 4
2016-12-20 14:38:42.1733 DEBUG Запрос: Select id, name, code, reestr, idsp, hospital_type_id, is_cure, is_inspection from codifiers.visit_purpose_common_tab order by id
2016-12-20 14:38:42.1733 DEBUG Получено записей: 22
2016-12-20 14:38:42.1893 DEBUG Запрос: Select id, name, code from codifiers.place_service_tab order by id
2016-12-20 14:38:42.1893 DEBUG Получено записей: 3
2016-12-20 14:38:42.1893 DEBUG Запрос: Select result_id, result, reestr, patient_state_id, reestr_rslt, reestr_ishod, _end from public.result_tab order by result_id
2016-12-20 14:38:42.2073 DEBUG Получено записей: 29
2016-12-20 14:38:42.2203 DEBUG Запрос: select id, name, code, bur_reestr_code from codifiers.travma_tab order by name;
2016-12-20 14:38:42.2373 DEBUG Получено записей: 15
2016-12-20 14:38:42.2373 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2016-12-20 14:38:42.2743 DEBUG Получено записей: 105
2016-12-20 14:38:42.6003 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2016-12-20 14:38:42.6123 DEBUG Получено записей: 105
2016-12-20 14:38:42.6123 DEBUG Запрос: select sp_napr_obosn_id,trim(obosn_name) as obosn_name FROM sp_napr_obosn_tab ORDER BY sp_napr_obosn_id;
2016-12-20 14:38:42.6263 DEBUG Получено записей: 8
2016-12-20 14:38:42.6263 DEBUG Запрос: SELECT sp_type_napr_id, sp_type_napr FROM sp_type_napr_tab ORDER BY 1;
2016-12-20 14:38:42.6263 DEBUG Получено записей: 9
2016-12-20 14:38:42.6493 DEBUG Запрос: select * from public.doctor_tab where sp_spec_doctor_id <> 900;
2016-12-20 14:38:42.7453 DEBUG Получено записей: 672
2016-12-20 14:39:09.0948 DEBUG Запрос: select id, code, name from codifiers.doctor_spec_tab order by 3,1;
2016-12-20 14:39:09.1018 DEBUG Получено записей: 175
2016-12-20 14:39:09.1018 DEBUG Запрос: Select mkb_id, mkb, kod_d, reestr_code from public.mkb_tab order by 1
2016-12-20 14:39:09.3098 DEBUG Получено записей: 13813
2016-12-20 14:39:14.9592 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2016-12-20 14:39:14.9592 DEBUG Получено записей: 11
2016-12-20 14:39:14.9742 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2016-12-20 14:39:15.0082 DEBUG Получено записей: 77
2016-12-20 14:39:15.0592 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2016-12-20 14:39:15.0592 DEBUG Получено записей: 107
2016-12-20 14:40:02.1419 DEBUG PatientFindForm ShowFilterByDoctor set to true
2016-12-20 14:40:02.1419 DEBUG PatientFindForm OperatorId: 2469
2016-12-20 14:40:02.1419 DEBUG PatientFindForm DoctorId: 2469
2016-12-20 14:40:02.2719 DEBUG DoctorQuery
2016-12-20 14:40:02.2719 DEBUG sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2016-12-20 14:40:02.2719 DEBUG @date: 20.12.2016
2016-12-20 14:40:02.2719 DEBUG @doctor: 2469
2016-12-20 14:40:02.2719 DEBUG bindQueryToDataGrid
2016-12-20 14:40:02.2869 DEBUG Sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2016-12-20 14:40:02.2869 DEBUG SqlParams:
2016-12-20 14:40:02.2869 DEBUG SqlParam @date='20.12.2016'
2016-12-20 14:40:02.2869 DEBUG SqlParam @doctor=2469
2016-12-20 14:40:16.3487 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam and Lower(d.nam) LIKE @nam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2016-12-20 14:40:16.3487 DEBUG SqlParams:
2016-12-20 14:40:16.3487 DEBUG SqlParam @fam=аветян%
2016-12-20 14:40:16.3487 DEBUG SqlParam @nam=мактах%
2016-12-20 14:40:20.9279 DEBUG Запрос: Select smo.id, smo.name, kladr.name from codifiers.strcom_tab smo left join codifiers.sp_kladr_tab kladr on smo.region_id = kladr.code where smo.region_id = @id and smo.name not like '*%'order by smo.name
2016-12-20 14:40:21.0019 DEBUG Получено записей: 4
2016-12-20 14:40:21.0649 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2016-12-20 14:40:21.0649 DEBUG Получено записей: 0
2016-12-20 14:40:21.0649 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2016-12-20 14:40:21.0909 DEBUG Получено записей: 0
2016-12-20 14:40:21.1360 DEBUG Запрос: SELECT t.talon_id, t.result_id, t.diag_osn, t.doctor_id, t.date_vnes_inf,
                        v.visit_id, v.doctor_id as vdoctor_id, v.data_vnes_inf as vdate_vnes_inf, v.data_pos 
                        FROM public.talon_tab t left join public.visit_tab v on v.talon_id = t.talon_id
                        where t.dan_id = @patient_id;
2016-12-20 14:40:21.1780 DEBUG Получено записей: 73
2016-12-20 14:40:22.0390 DEBUG Запрос: Select visit_id from public.visit_tab where talon_id = @talonId;
2016-12-20 14:40:22.0390 DEBUG Получено записей: 0
2016-12-20 14:40:22.0730 DEBUG Запрос: SELECT d.id FROM diagn_tab d WHERE d.talon_id = @caseId ORDER BY d.id desc;
2016-12-20 14:40:22.0770 DEBUG Получено записей: 0
2016-12-20 15:22:26.4024 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:26.4384 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:26.4624 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:26.4834 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:26.5074 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:26.5274 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:26.5434 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:26.5644 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:26.5794 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:26.5994 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:26.6154 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:26.6354 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:26.6514 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:26.6714 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:26.7264 DEBUG Запрос: select id, name from codifiers.sp_kind_paid_tab order by 1
2016-12-20 15:22:27.3184 DEBUG Запрос: select id,name from codifiers.lpu_building_tab
2016-12-20 15:22:29.7816 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2016-12-20 15:22:30.3476 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2016-12-20 15:22:30.3986 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2016-12-20 15:22:30.5086 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:30.5256 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:30.5436 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:30.5576 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:30.5726 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:30.5726 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:30.6016 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:30.6146 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:30.6326 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:30.6476 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:30.6646 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:30.6806 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:30.6986 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 15:22:30.7146 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 15:22:35.1409 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                             order by 2
2016-12-20 15:22:59.9373 DEBUG Запрос: SELECT DISTINCT code_access, name, description FROM users_access_view WHERE users_id = @id
2016-12-20 15:22:59.9493 DEBUG Получено записей: 187
2016-12-20 15:23:00.1833 DEBUG Запрос: SELECT DISTINCT code_access, name, description FROM users_access_view WHERE users_id = @id
2016-12-20 15:23:00.1953 DEBUG Получено записей: 187
2016-12-20 15:52:19.9900 DEBUG Запрос: SELECT DISTINCT code_access, name, description FROM users_access_view WHERE users_id = @id
2016-12-20 15:52:20.0400 DEBUG Получено записей: 187
2016-12-20 15:52:22.0361 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2016-12-20 15:52:22.0361 DEBUG Parameters: @patterncode=, @operator=
2016-12-20 15:52:22.0701 DEBUG Result 
2016-12-20 15:52:22.0711 DEBUG нет шаблона для пользователя
2016-12-20 15:52:22.0711 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2016-12-20 15:52:22.0711 DEBUG Parameters: @patterncode 
2016-12-20 15:52:22.0711 DEBUG Result 
2016-12-20 15:52:22.1241 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2016-12-20 15:52:22.1241 DEBUG Parameters: @patterncode=, @operator=
2016-12-20 15:52:22.1351 DEBUG Result 
2016-12-20 15:52:22.1351 DEBUG нет шаблона для пользователя
2016-12-20 15:52:22.1351 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2016-12-20 15:52:22.1351 DEBUG Parameters: @patterncode 
2016-12-20 15:52:22.1351 DEBUG Result 
2016-12-20 15:52:22.4081 DEBUG Запрос: Select id, name, code, is_default, parent_id from codifiers.sp_kind_paid_tab order by id
2016-12-20 15:52:22.4081 DEBUG Получено записей: 9
2016-12-20 15:52:22.4201 DEBUG Запрос: Select id, name, code from codifiers.first_visit_condition_tab order by id
2016-12-20 15:52:22.4201 DEBUG Получено записей: 4
2016-12-20 15:52:22.4321 DEBUG Запрос: Select id, name, code, reestr, idsp, hospital_type_id, is_cure, is_inspection from codifiers.visit_purpose_common_tab order by id
2016-12-20 15:52:22.4321 DEBUG Получено записей: 22
2016-12-20 15:52:22.4461 DEBUG Запрос: Select id, name, code from codifiers.place_service_tab order by id
2016-12-20 15:52:22.4461 DEBUG Получено записей: 3
2016-12-20 15:52:22.4461 DEBUG Запрос: Select result_id, result, reestr, patient_state_id, reestr_rslt, reestr_ishod, _end from public.result_tab order by result_id
2016-12-20 15:52:22.4611 DEBUG Получено записей: 29
2016-12-20 15:52:22.4611 DEBUG Запрос: select id, name, code, bur_reestr_code from codifiers.travma_tab order by name;
2016-12-20 15:52:22.4611 DEBUG Получено записей: 15
2016-12-20 15:52:22.4831 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2016-12-20 15:52:22.5011 DEBUG Получено записей: 105
2016-12-20 15:52:22.7491 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2016-12-20 15:52:22.7601 DEBUG Получено записей: 105
2016-12-20 15:52:22.7601 DEBUG Запрос: select sp_napr_obosn_id,trim(obosn_name) as obosn_name FROM sp_napr_obosn_tab ORDER BY sp_napr_obosn_id;
2016-12-20 15:52:22.7741 DEBUG Получено записей: 8
2016-12-20 15:52:22.7741 DEBUG Запрос: SELECT sp_type_napr_id, sp_type_napr FROM sp_type_napr_tab ORDER BY 1;
2016-12-20 15:52:22.7741 DEBUG Получено записей: 9
2016-12-20 15:52:22.7961 DEBUG Запрос: select * from public.doctor_tab where sp_spec_doctor_id <> 900;
2016-12-20 15:52:22.8901 DEBUG Получено записей: 672
2016-12-20 15:52:48.7156 DEBUG Запрос: select id, code, name from codifiers.doctor_spec_tab order by 3,1;
2016-12-20 15:52:48.7156 DEBUG Получено записей: 175
2016-12-20 15:52:48.7346 DEBUG Запрос: Select mkb_id, mkb, kod_d, reestr_code from public.mkb_tab order by 1
2016-12-20 15:52:48.9056 DEBUG Получено записей: 13813
2016-12-20 15:55:15.4770 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2016-12-20 15:55:15.4770 DEBUG Получено записей: 11
2016-12-20 15:55:15.4970 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2016-12-20 15:55:15.4970 DEBUG Получено записей: 77
2016-12-20 15:55:15.5560 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2016-12-20 15:55:15.5640 DEBUG Получено записей: 107
2016-12-20 16:01:57.8310 DEBUG PatientFindForm ShowFilterByDoctor set to true
2016-12-20 16:01:57.8310 DEBUG PatientFindForm OperatorId: 2469
2016-12-20 16:01:57.8310 DEBUG PatientFindForm DoctorId: 2469
2016-12-20 16:01:59.7031 DEBUG DoctorQuery
2016-12-20 16:01:59.7031 DEBUG sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2016-12-20 16:01:59.7031 DEBUG @date: 20.12.2016
2016-12-20 16:01:59.7031 DEBUG @doctor: 2469
2016-12-20 16:01:59.7371 DEBUG bindQueryToDataGrid
2016-12-20 16:01:59.7531 DEBUG Sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2016-12-20 16:01:59.7531 DEBUG SqlParams:
2016-12-20 16:01:59.7531 DEBUG SqlParam @date='20.12.2016'
2016-12-20 16:01:59.7531 DEBUG SqlParam @doctor=2469
2016-12-20 16:02:16.4151 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam and Lower(d.nam) LIKE @nam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2016-12-20 16:02:16.4151 DEBUG SqlParams:
2016-12-20 16:02:16.4151 DEBUG SqlParam @fam=аветян%
2016-12-20 16:02:16.4151 DEBUG SqlParam @nam=мактах%
2016-12-20 16:02:20.7433 DEBUG Запрос: Select smo.id, smo.name, kladr.name from codifiers.strcom_tab smo left join codifiers.sp_kladr_tab kladr on smo.region_id = kladr.code where smo.region_id = @id and smo.name not like '*%'order by smo.name
2016-12-20 16:02:20.8173 DEBUG Получено записей: 4
2016-12-20 16:02:20.8863 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2016-12-20 16:02:20.8863 DEBUG Получено записей: 0
2016-12-20 16:02:20.8983 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2016-12-20 16:02:20.8983 DEBUG Получено записей: 0
2016-12-20 16:02:31.7640 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2016-12-20 16:02:31.7640 DEBUG Получено записей: 11
2016-12-20 16:02:31.7760 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2016-12-20 16:02:31.7760 DEBUG Получено записей: 77
2016-12-20 16:02:31.8340 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2016-12-20 16:02:31.8340 DEBUG Получено записей: 107
2016-12-20 16:03:32.8645 DEBUG Запрос: SELECT DISTINCT code_access, name, description FROM users_access_view WHERE users_id = @id
2016-12-20 16:03:32.9145 DEBUG Получено записей: 187
2016-12-20 16:03:35.2666 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2016-12-20 16:03:35.2666 DEBUG Parameters: @patterncode=, @operator=
2016-12-20 16:03:35.3236 DEBUG Result 
2016-12-20 16:03:35.3246 DEBUG нет шаблона для пользователя
2016-12-20 16:03:35.3246 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2016-12-20 16:03:35.3246 DEBUG Parameters: @patterncode 
2016-12-20 16:03:35.3246 DEBUG Result 
2016-12-20 16:03:35.3886 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2016-12-20 16:03:35.3886 DEBUG Parameters: @patterncode=, @operator=
2016-12-20 16:03:35.3886 DEBUG Result 
2016-12-20 16:03:35.3886 DEBUG нет шаблона для пользователя
2016-12-20 16:03:35.3886 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2016-12-20 16:03:35.3886 DEBUG Parameters: @patterncode 
2016-12-20 16:03:35.4116 DEBUG Result 
2016-12-20 16:03:35.7936 DEBUG Запрос: Select id, name, code, is_default, parent_id from codifiers.sp_kind_paid_tab order by id
2016-12-20 16:03:35.7936 DEBUG Получено записей: 9
2016-12-20 16:03:35.7936 DEBUG Запрос: Select id, name, code from codifiers.first_visit_condition_tab order by id
2016-12-20 16:03:35.8106 DEBUG Получено записей: 4
2016-12-20 16:03:35.8106 DEBUG Запрос: Select id, name, code, reestr, idsp, hospital_type_id, is_cure, is_inspection from codifiers.visit_purpose_common_tab order by id
2016-12-20 16:03:35.8266 DEBUG Получено записей: 22
2016-12-20 16:03:35.8266 DEBUG Запрос: Select id, name, code from codifiers.place_service_tab order by id
2016-12-20 16:03:35.8416 DEBUG Получено записей: 3
2016-12-20 16:03:35.8416 DEBUG Запрос: Select result_id, result, reestr, patient_state_id, reestr_rslt, reestr_ishod, _end from public.result_tab order by result_id
2016-12-20 16:03:35.8556 DEBUG Получено записей: 29
2016-12-20 16:03:35.8556 DEBUG Запрос: select id, name, code, bur_reestr_code from codifiers.travma_tab order by name;
2016-12-20 16:03:35.8716 DEBUG Получено записей: 15
2016-12-20 16:03:35.8716 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2016-12-20 16:03:35.9226 DEBUG Получено записей: 105
2016-12-20 16:03:36.2527 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2016-12-20 16:03:36.2647 DEBUG Получено записей: 105
2016-12-20 16:03:36.2647 DEBUG Запрос: select sp_napr_obosn_id,trim(obosn_name) as obosn_name FROM sp_napr_obosn_tab ORDER BY sp_napr_obosn_id;
2016-12-20 16:03:36.2787 DEBUG Получено записей: 8
2016-12-20 16:03:36.2787 DEBUG Запрос: SELECT sp_type_napr_id, sp_type_napr FROM sp_type_napr_tab ORDER BY 1;
2016-12-20 16:03:36.2927 DEBUG Получено записей: 9
2016-12-20 16:03:36.2927 DEBUG Запрос: select * from public.doctor_tab where sp_spec_doctor_id <> 900;
2016-12-20 16:03:36.4007 DEBUG Получено записей: 672
2016-12-20 16:04:02.4112 DEBUG Запрос: select id, code, name from codifiers.doctor_spec_tab order by 3,1;
2016-12-20 16:04:02.4112 DEBUG Получено записей: 175
2016-12-20 16:04:02.4292 DEBUG Запрос: Select mkb_id, mkb, kod_d, reestr_code from public.mkb_tab order by 1
2016-12-20 16:04:02.6232 DEBUG Получено записей: 13813
2016-12-20 16:04:24.6484 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2016-12-20 16:04:24.6484 DEBUG Получено записей: 11
2016-12-20 16:04:24.6684 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2016-12-20 16:04:24.6684 DEBUG Получено записей: 77
2016-12-20 16:04:24.7264 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2016-12-20 16:04:24.7344 DEBUG Получено записей: 107
2016-12-20 16:08:08.9383 DEBUG PatientFindForm ShowFilterByDoctor set to true
2016-12-20 16:08:08.9383 DEBUG PatientFindForm OperatorId: 2469
2016-12-20 16:08:08.9383 DEBUG PatientFindForm DoctorId: 2469
2016-12-20 16:08:09.0673 DEBUG DoctorQuery
2016-12-20 16:08:09.0673 DEBUG sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2016-12-20 16:08:09.0673 DEBUG @date: 20.12.2016
2016-12-20 16:08:09.0673 DEBUG @doctor: 2469
2016-12-20 16:08:09.0673 DEBUG bindQueryToDataGrid
2016-12-20 16:08:09.0813 DEBUG Sql: SELECT td.time_nazn as "Время записи", d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен", case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d LEFT JOIN public.talon_doctor_tab td on td.dan_id = d.dan_id WHERE td.date_nazn = date(@date) and td.doctor_id = @doctor;
2016-12-20 16:08:09.0813 DEBUG SqlParams:
2016-12-20 16:08:09.0813 DEBUG SqlParam @date='20.12.2016'
2016-12-20 16:08:09.0813 DEBUG SqlParam @doctor=2469
2016-12-20 16:23:21.0544 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam and Lower(d.nam) LIKE @nam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2016-12-20 16:23:21.0544 DEBUG SqlParams:
2016-12-20 16:23:21.0544 DEBUG SqlParam @fam=аветян%
2016-12-20 16:23:21.0544 DEBUG SqlParam @nam=мактах%
2016-12-20 16:23:25.6777 DEBUG Запрос: Select smo.id, smo.name, kladr.name from codifiers.strcom_tab smo left join codifiers.sp_kladr_tab kladr on smo.region_id = kladr.code where smo.region_id = @id and smo.name not like '*%'order by smo.name
2016-12-20 16:23:25.7537 DEBUG Получено записей: 4
2016-12-20 16:23:25.8337 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2016-12-20 16:23:25.8337 DEBUG Получено записей: 0
2016-12-20 16:23:25.8467 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2016-12-20 16:23:25.8467 DEBUG Получено записей: 0
2016-12-20 16:23:25.9127 DEBUG Запрос: SELECT t.talon_id, t.result_id, t.diag_osn, t.doctor_id, t.date_vnes_inf,
                        v.visit_id, v.doctor_id as vdoctor_id, v.data_vnes_inf as vdate_vnes_inf, v.data_pos 
                        FROM public.talon_tab t left join public.visit_tab v on v.talon_id = t.talon_id
                        where t.dan_id = @patient_id;
2016-12-20 16:23:25.9487 DEBUG Получено записей: 73
2016-12-20 16:23:26.8698 DEBUG Запрос: Select visit_id from public.visit_tab where talon_id = @talonId;
2016-12-20 16:23:26.8698 DEBUG Получено записей: 0
2016-12-20 16:23:26.9088 DEBUG Запрос: SELECT d.id FROM diagn_tab d WHERE d.talon_id = @caseId ORDER BY d.id desc;
2016-12-20 16:23:26.9088 DEBUG Получено записей: 0
2016-12-20 16:23:32.4001 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:32.4331 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:32.4511 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:32.4721 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:32.4871 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:32.5081 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:32.5231 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:32.5431 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:32.5571 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:32.5771 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:32.5911 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:32.6111 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:32.6261 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:32.6471 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:32.6991 DEBUG Запрос: select id, name from codifiers.sp_kind_paid_tab order by 1
2016-12-20 16:23:33.2711 DEBUG Запрос: select id,name from codifiers.lpu_building_tab
2016-12-20 16:23:35.7603 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2016-12-20 16:23:36.3333 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2016-12-20 16:23:36.3883 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2016-12-20 16:23:36.5053 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:36.5213 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:36.5393 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:36.5553 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:36.5733 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:36.5893 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:36.6063 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:36.6223 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:36.6403 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:36.6563 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:36.6743 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:36.6903 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:36.7083 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:36.7243 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:46.3499 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2016-12-20 16:23:49.9351 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:49.9641 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:50.4051 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:50.4421 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:50.4591 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:50.4861 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:50.5041 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:50.5301 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:50.5491 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:50.5761 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:50.5951 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:50.6281 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:50.6461 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:50.6731 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:50.7291 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:23:50.7771 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:23:50.9391 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:23:50.9771 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:23:51.0551 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:23:51.1991 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:23:51.4442 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:23:51.4932 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:23:51.7542 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:23:51.9822 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:23:52.1282 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:23:55.0274 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:55.0534 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:55.4554 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:55.4814 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:55.4994 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:55.5274 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:55.5444 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:55.5714 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:55.5894 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:55.6164 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:55.6334 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:55.6584 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:55.6764 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:55.7014 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:56.3724 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:56.3974 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:56.4154 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:56.4424 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:56.4604 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:56.4854 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:56.5044 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:56.5295 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:56.5485 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:56.5745 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:56.5915 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:56.6175 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:56.6355 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:23:56.6595 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:23:59.7926 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 16:23:59.9006 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 16:26:09.3460 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2016-12-20 16:26:16.3254 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:26:16.3534 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:26:16.3704 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:26:16.3915 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:26:16.8655 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:26:16.8875 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:26:16.9065 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:26:16.9275 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:26:16.9455 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:26:16.9685 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:26:16.9865 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:26:17.0075 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:26:17.0255 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2016-12-20 16:26:17.0465 DEBUG Запрос:  select td.date_nazn talontime, 
                                td.doctor_id doctorid, 
                                td.cabinet_nam cabinetname,
                                td.dan_id patientid
                                from talon_doctor_tab td
                                where td.doctor_id=@DocId 
                                and td.date_nazn=@Date 
                                and td.time_nazn is null
2016-12-20 16:26:18.8986 DEBUG Запрос:  select td.date_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn is null
2016-12-20 16:26:19.5236 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:19.6346 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:19.7406 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:19.8506 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:19.9547 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:19.9967 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:20.0827 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:20.1087 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:20.1947 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:20.2217 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:20.3147 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:20.3407 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:20.4517 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:20.4777 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:20.5907 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:20.7337 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:21.0987 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:21.9798 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:22.0978 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:22.2898 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:23.5249 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:23.7379 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:23.8589 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:24.1059 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:24.2189 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:24.3219 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:48.8633 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:49.6774 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:49.7694 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:49.8894 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:49.9944 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:50.0494 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:50.0994 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:50.2104 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:50.3294 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:50.4424 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:51.0664 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:51.1544 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:51.2664 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:51.2914 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:51.3144 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:51.4015 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:51.4265 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:51.4975 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2016-12-20 16:26:51.6105 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
