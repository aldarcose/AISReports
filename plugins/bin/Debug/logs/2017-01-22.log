2017-01-22 12:41:36.6196 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-22 12:41:36.6776 DEBUG Получено записей: 1
2017-01-22 12:41:41.6879 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-22 12:41:41.6879 DEBUG Получено записей: 11
2017-01-22 12:41:41.6879 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-22 12:41:41.7089 DEBUG Получено записей: 75
2017-01-22 12:41:41.7599 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-22 12:41:41.7669 DEBUG Получено записей: 0
2017-01-22 12:41:48.8213 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-22 12:41:48.8213 DEBUG PatientFindForm OperatorId: 2470
2017-01-22 12:41:48.8213 DEBUG PatientFindForm DoctorId: -1
2017-01-22 12:41:50.5164 DEBUG _loggedOperator.DoctorId==-1
2017-01-22 12:41:50.5454 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-22 12:41:50.5524 DEBUG Получено записей: 1
2017-01-22 12:41:50.5864 DEBUG _loggedOperator.DoctorId:-1
2017-01-22 12:42:05.0412 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-22 12:42:05.0412 DEBUG SqlParams:
2017-01-22 12:42:05.0412 DEBUG SqlParam @fam=радна%
2017-01-22 12:42:09.3905 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-22 12:42:09.3935 DEBUG Получено записей: 0
2017-01-22 12:42:09.3935 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-22 12:42:09.3935 DEBUG Получено записей: 0
2017-01-22 12:42:44.6695 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.dan_id = dan.dan_id
                             where doc.expiration_date>@ExpDate  order by 2
2017-01-22 12:43:14.1702 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-22 12:43:14.2702 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 12:43:14.2972 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 12:43:14.3252 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-22 12:43:14.3852 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-22 12:43:14.3852 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 12:43:14.4172 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 12:43:14.5472 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:14.7142 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:14.7892 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:14.8732 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:14.9382 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:15.0032 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:15.1522 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:15.2593 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:15.3363 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:15.4103 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:15.4843 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:15.5433 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:15.6273 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:15.6923 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:18.4394 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:18.5124 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:18.6964 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:20.0405 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:20.1535 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:20.1735 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:20.2645 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:20.2845 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:20.3675 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:20.3925 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:21.3366 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:21.4406 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:23.1767 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:26.4399 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-22 12:43:26.4489 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 12:43:27.2669 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:27.7640 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:27.8530 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:27.9530 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:28.0300 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:28.0970 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:28.1740 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:32.6072 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-22 12:43:32.6202 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 12:43:33.1903 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:33.3323 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:33.4173 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:33.4973 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:33.5633 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:33.6323 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:33.7043 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:43:34.7844 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:34.8044 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:34.8964 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:34.9174 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:35.0094 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:35.1204 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:35.1604 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:35.2414 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:35.3514 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:35.4724 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:36.2515 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:36.3355 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:36.4395 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:36.8775 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:37.2125 DEBUG Запрос: select id,name,color from codifiers.vid_talon_tab order by id 
2017-01-22 12:43:37.2275 DEBUG Запрос: select id,name,color from codifiers.vid_talon_tab order by id 
2017-01-22 12:43:50.7443 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:50.8563 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:50.9613 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:50.9943 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:43:51.6233 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 12:44:03.2460 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-22 12:44:03.2460 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 12:44:03.2750 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 12:44:03.3030 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-22 12:44:03.3290 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-22 12:44:03.3290 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 12:44:03.3530 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 12:44:03.4330 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:44:03.5020 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:44:03.5680 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:44:03.6370 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:44:03.7030 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:44:03.7770 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:44:03.8440 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:44:03.9410 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:44:04.0070 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:44:04.1060 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:44:04.1730 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:44:04.2411 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:44:04.3071 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:44:04.3731 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 12:59:23.7486 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-22 12:59:23.7926 DEBUG Получено записей: 1
2017-01-22 12:59:28.3369 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-22 12:59:28.3369 DEBUG Получено записей: 11
2017-01-22 12:59:28.3529 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-22 12:59:28.3529 DEBUG Получено записей: 75
2017-01-22 12:59:28.4079 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-22 12:59:28.4079 DEBUG Получено записей: 0
2017-01-22 12:59:48.1320 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-22 12:59:48.1320 DEBUG PatientFindForm OperatorId: 2470
2017-01-22 12:59:48.1320 DEBUG PatientFindForm DoctorId: -1
2017-01-22 12:59:48.6191 DEBUG _loggedOperator.DoctorId==-1
2017-01-22 12:59:49.8121 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-22 12:59:49.8121 DEBUG Получено записей: 1
2017-01-22 12:59:49.8551 DEBUG _loggedOperator.DoctorId:-1
2017-01-22 13:01:22.2404 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-22 13:01:22.2664 DEBUG Получено записей: 102
2017-01-22 13:03:15.5969 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-22 13:03:15.6429 DEBUG Получено записей: 2
2017-01-22 13:03:20.1822 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-22 13:03:20.1822 DEBUG Получено записей: 11
2017-01-22 13:03:20.1982 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-22 13:03:20.1982 DEBUG Получено записей: 75
2017-01-22 13:03:20.2532 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-22 13:03:20.2572 DEBUG Получено записей: 0
2017-01-22 13:03:38.2402 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.dan_id = dan.dan_id
                             where doc.expiration_date>@ExpDate  order by 2
2017-01-22 13:03:48.2638 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-22 13:03:49.0488 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-22 13:03:49.0708 DEBUG Получено записей: 102
2017-01-22 13:03:49.1718 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-22 13:03:49.2048 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-22 13:03:49.2108 DEBUG Получено записей: 75
2017-01-22 13:14:29.5375 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-22 13:14:29.5895 DEBUG Получено записей: 2
2017-01-22 13:14:39.0820 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-22 13:14:39.0820 DEBUG Получено записей: 11
2017-01-22 13:14:39.0990 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-22 13:14:39.0990 DEBUG Получено записей: 75
2017-01-22 13:14:39.1590 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-22 13:14:39.1590 DEBUG Получено записей: 0
2017-01-22 13:18:45.4281 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-22 13:18:45.4741 DEBUG Получено записей: 2
2017-01-22 13:18:49.7943 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-22 13:18:49.7943 DEBUG Получено записей: 11
2017-01-22 13:18:49.8103 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-22 13:18:49.8103 DEBUG Получено записей: 75
2017-01-22 13:18:49.8683 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-22 13:18:49.8683 DEBUG Получено записей: 0
2017-01-22 13:18:58.2578 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.dan_id = dan.dan_id
                             where doc.expiration_date>@ExpDate  order by 2
2017-01-22 13:19:07.2183 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-22 13:19:07.2803 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 13:19:07.3093 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 13:19:07.3633 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-22 13:19:07.4063 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-22 13:19:07.4063 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 13:19:07.4333 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 13:19:07.5874 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 13:19:07.7154 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 13:19:07.7944 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 13:19:07.8814 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 13:19:07.9504 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 13:19:08.0144 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 13:19:08.0824 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 13:19:08.2034 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 13:19:08.2804 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 13:19:08.3594 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 13:19:08.4384 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 13:19:08.5024 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 13:19:08.5714 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 13:19:08.6314 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:17.6165 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.dan_id = dan.dan_id
                             where doc.expiration_date>@ExpDate  order by 2
2017-01-22 15:44:38.1267 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-22 15:44:38.1387 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 15:44:38.1557 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 15:44:38.1817 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-22 15:44:38.2057 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-22 15:44:38.2057 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 15:44:38.2277 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 15:44:38.3087 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:38.3837 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:38.4617 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:38.5387 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:38.6047 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:38.6837 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:38.7668 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:38.8648 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:38.9418 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:39.0348 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:39.1108 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:39.1778 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:39.2438 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:39.3158 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 15:44:39.3858 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 15:44:39.9378 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 15:44:40.2568 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 15:44:41.8419 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 15:44:41.9539 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-01-22 16:24:58.1311 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-22 16:24:58.1761 DEBUG Получено записей: 2
2017-01-22 16:25:02.9094 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-22 16:25:02.9094 DEBUG Получено записей: 11
2017-01-22 16:25:02.9274 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-22 16:25:02.9274 DEBUG Получено записей: 75
2017-01-22 16:25:02.9864 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-22 16:25:03.0014 DEBUG Получено записей: 0
2017-01-22 16:25:12.0209 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.dan_id = dan.dan_id
                             where doc.expiration_date>@ExpDate anddoc.sp_lpu_id=@LPUId order by 2
2017-01-22 16:28:16.0335 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-22 16:28:16.0775 DEBUG Получено записей: 2
2017-01-22 16:28:20.4467 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-22 16:28:20.4467 DEBUG Получено записей: 11
2017-01-22 16:28:20.4627 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-22 16:28:20.4677 DEBUG Получено записей: 75
2017-01-22 16:28:20.5197 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-22 16:28:20.5197 DEBUG Получено записей: 0
2017-01-22 16:28:30.1353 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.dan_id = dan.dan_id
                             where doc.expiration_date>@ExpDate  and doc.sp_lpu_id=@LPUId order by 2
2017-01-22 16:28:42.5340 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-22 16:28:42.5970 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 16:28:42.6510 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 16:28:42.6800 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-22 16:28:42.7210 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-22 16:28:42.7210 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 16:28:42.7450 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-22 16:28:42.8900 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 16:28:43.0180 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 16:28:43.0950 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 16:28:43.1790 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 16:28:43.2460 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 16:28:43.3120 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 16:28:43.3780 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 16:28:43.4870 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 16:28:43.5630 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 16:28:43.6390 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 16:28:43.7140 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 16:28:43.7880 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 16:28:43.8510 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-22 16:28:43.9110 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
