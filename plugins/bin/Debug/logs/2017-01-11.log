2017-01-11 08:59:10.4936 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 08:59:10.5526 DEBUG Получено записей: 2
2017-01-11 08:59:15.7909 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 08:59:15.7959 DEBUG Получено записей: 11
2017-01-11 08:59:15.8089 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 08:59:15.8089 DEBUG Получено записей: 75
2017-01-11 08:59:15.8699 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 08:59:15.8759 DEBUG Получено записей: 0
2017-01-11 08:59:22.6213 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-11 08:59:22.6513 DEBUG Получено записей: 0
2017-01-11 08:59:22.6583 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-11 08:59:22.6583 DEBUG Получено записей: 0
2017-01-11 08:59:32.2439 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-11 08:59:32.2439 DEBUG Получено записей: 0
2017-01-11 08:59:32.2539 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-11 08:59:32.2539 DEBUG Получено записей: 0
2017-01-11 09:10:41.7042 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 09:10:41.7572 DEBUG Получено записей: 2
2017-01-11 09:10:45.6754 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 09:10:45.6774 DEBUG Получено записей: 11
2017-01-11 09:10:45.6774 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 09:10:45.6964 DEBUG Получено записей: 75
2017-01-11 09:10:45.7564 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 09:10:45.7564 DEBUG Получено записей: 0
2017-01-11 09:10:56.0830 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-11 09:10:56.0830 DEBUG Получено записей: 0
2017-01-11 09:10:56.0830 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-11 09:10:56.0830 DEBUG Получено записей: 0
2017-01-11 09:12:58.7010 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-11 09:12:58.7010 DEBUG PatientFindForm OperatorId: 303001
2017-01-11 09:12:58.7010 DEBUG PatientFindForm DoctorId: -1
2017-01-11 09:13:00.8401 DEBUG _loggedOperator.DoctorId==-1
2017-01-11 09:13:00.8651 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 09:13:00.8721 DEBUG Получено записей: 2
2017-01-11 09:13:00.8921 DEBUG _loggedOperator.DoctorId:-1
2017-01-11 09:13:12.3278 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-11 09:13:12.3278 DEBUG SqlParams:
2017-01-11 09:13:12.3278 DEBUG SqlParam @fam=снег%
2017-01-11 09:13:18.0981 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-11 09:13:18.1051 DEBUG Получено записей: 0
2017-01-11 09:13:18.1051 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-11 09:13:18.1051 DEBUG Получено записей: 0
2017-01-11 09:13:25.3075 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-11 09:13:25.3075 DEBUG PatientFindForm OperatorId: 303001
2017-01-11 09:13:25.3075 DEBUG PatientFindForm DoctorId: -1
2017-01-11 09:13:25.4395 DEBUG _loggedOperator.DoctorId==-1
2017-01-11 09:13:27.1876 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 09:13:27.1876 DEBUG Получено записей: 2
2017-01-11 09:13:27.2136 DEBUG _loggedOperator.DoctorId:-1
2017-01-11 09:13:42.3255 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-11 09:13:42.3255 DEBUG SqlParams:
2017-01-11 09:13:42.3255 DEBUG SqlParam @fam=иванов%
2017-01-11 09:13:46.2757 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-11 09:13:46.2787 DEBUG Получено записей: 0
2017-01-11 09:13:46.8908 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-11 09:13:46.8908 DEBUG Получено записей: 0
2017-01-11 09:16:34.5534 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 09:16:34.6004 DEBUG Получено записей: 2
2017-01-11 09:16:38.8146 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 09:16:38.8166 DEBUG Получено записей: 11
2017-01-11 09:16:38.8166 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 09:16:38.8366 DEBUG Получено записей: 75
2017-01-11 09:16:38.8906 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 09:16:38.8946 DEBUG Получено записей: 0
2017-01-11 09:16:47.5491 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-11 09:16:47.5491 DEBUG PatientFindForm OperatorId: 303001
2017-01-11 09:16:47.5491 DEBUG PatientFindForm DoctorId: -1
2017-01-11 09:16:48.1141 DEBUG _loggedOperator.DoctorId==-1
2017-01-11 09:16:48.1311 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 09:16:48.1311 DEBUG Получено записей: 2
2017-01-11 09:16:49.8822 DEBUG _loggedOperator.DoctorId:-1
2017-01-11 09:17:00.1968 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-11 09:17:00.1968 DEBUG SqlParams:
2017-01-11 09:17:00.1968 DEBUG SqlParam @fam=снег%
2017-01-11 09:17:05.7131 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-11 09:17:05.7131 DEBUG Получено записей: 0
2017-01-11 09:17:05.7131 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-11 09:17:05.7131 DEBUG Получено записей: 0
2017-01-11 09:25:04.6555 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 09:25:04.7035 DEBUG Получено записей: 2
2017-01-11 09:25:10.4939 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 09:25:10.4939 DEBUG Получено записей: 11
2017-01-11 09:25:10.5089 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 09:25:10.5149 DEBUG Получено записей: 75
2017-01-11 09:25:10.5679 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 09:25:10.5679 DEBUG Получено записей: 0
2017-01-11 09:25:21.2855 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-01-11 09:25:21.2855 DEBUG PatientFindForm OperatorId: 303001
2017-01-11 09:25:21.2855 DEBUG PatientFindForm DoctorId: -1
2017-01-11 09:25:25.2057 DEBUG _loggedOperator.DoctorId==-1
2017-01-11 09:25:25.2237 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 09:25:25.2307 DEBUG Получено записей: 2
2017-01-11 09:25:25.2507 DEBUG _loggedOperator.DoctorId:-1
2017-01-11 09:25:43.3007 DEBUG Sql: SELECT d.dan_id as "Id", d.fam as "Фамилия", d.nam as "Имя", d.mid as "Отчество", d.date_born as "Дата рождения", case when d.ser_pol is null then d.num_pol else d.ser_pol ||' '|| d.num_pol end as "Полис", d.pens as "СНИЛС", d.address as "Адрес", case when spolref='2301001' then true else false end as "Прикреплен" , case when strcom_region_id='0300000000000' then false else true end as "Иногородний" FROM dan_tab d WHERE Lower(d.fam) LIKE @fam ORDER BY d.fam, d.nam, d.mid, d.date_born LIMIT 150;
2017-01-11 09:25:43.3007 DEBUG SqlParams:
2017-01-11 09:25:43.3007 DEBUG SqlParam @fam=снег%
2017-01-11 09:25:52.3433 DEBUG Запрос: select * from fed_lgota_tab where pens like @snils;
2017-01-11 09:25:52.3433 DEBUG Получено записей: 0
2017-01-11 09:25:52.3553 DEBUG Запрос: select * from lgot_client_tab where dan_id = @id;
2017-01-11 09:25:52.3553 DEBUG Получено записей: 0
2017-01-11 09:26:15.2546 DEBUG Запрос: 
2017-01-11 09:26:27.8423 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-11 09:26:27.9433 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-11 09:26:27.9653 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-11 09:26:27.9933 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 09:26:28.0543 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-11 09:26:28.0543 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-11 09:26:28.0783 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-11 09:26:28.2773 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 09:26:28.3773 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 09:26:28.4343 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 09:26:28.4923 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 09:26:28.5603 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 09:26:28.6263 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 09:26:28.7083 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 09:26:28.8153 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 09:26:28.8933 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 09:26:28.9644 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 09:26:29.0464 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 09:26:29.1114 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 09:26:29.1794 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 09:26:29.2494 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 10:17:22.5510 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 10:17:22.5980 DEBUG Получено записей: 2
2017-01-11 10:17:28.5324 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 10:17:28.5384 DEBUG Получено записей: 11
2017-01-11 10:17:28.5384 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 10:17:28.5574 DEBUG Получено записей: 75
2017-01-11 10:17:28.6054 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 10:17:28.6054 DEBUG Получено записей: 0
2017-01-11 10:17:38.7349 DEBUG Запрос: 
2017-01-11 10:18:11.8518 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 10:18:12.2268 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2017-01-11 10:18:12.2529 DEBUG Получено записей: 102
2017-01-11 10:18:12.3459 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-11 10:18:12.3809 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 10:18:12.3809 DEBUG Получено записей: 75
2017-01-11 13:52:56.4688 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 13:52:56.5238 DEBUG Получено записей: 2
2017-01-11 13:53:17.4050 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 13:53:17.4050 DEBUG Получено записей: 11
2017-01-11 13:53:17.4310 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 13:53:17.4310 DEBUG Получено записей: 75
2017-01-11 13:53:17.4920 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 13:53:17.5890 DEBUG Получено записей: 0
2017-01-11 13:53:44.7165 DEBUG Запрос: 
2017-01-11 13:54:22.5307 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-11 13:54:22.5667 DEBUG Получено записей: 102
2017-01-11 13:54:22.7687 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-11 13:54:22.8097 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 13:54:22.8167 DEBUG Получено записей: 75
2017-01-11 13:55:07.3833 DEBUG Запрос: 
2017-01-11 13:55:17.6069 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 13:55:17.9069 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-11 13:55:17.9189 DEBUG Получено записей: 102
2017-01-11 13:55:17.9739 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-11 13:55:18.0029 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 13:55:18.0099 DEBUG Получено записей: 75
2017-01-11 13:58:44.5847 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 13:58:44.6317 DEBUG Получено записей: 2
2017-01-11 13:58:50.6850 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 13:58:50.6850 DEBUG Получено записей: 11
2017-01-11 13:58:50.7460 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 13:58:50.7460 DEBUG Получено записей: 75
2017-01-11 13:58:50.8061 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 13:58:50.8061 DEBUG Получено записей: 0
2017-01-11 13:59:02.4607 DEBUG Запрос: 
2017-01-11 13:59:15.5975 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 13:59:15.9255 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-11 13:59:15.9435 DEBUG Получено записей: 102
2017-01-11 13:59:16.0285 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-11 13:59:16.0655 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 13:59:16.0655 DEBUG Получено записей: 75
2017-01-11 13:59:41.4519 ERROR Cannot open connection: Failed to establish a connection to '192.168.16.253'.
2017-01-11 14:12:26.8487 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 14:12:26.8937 DEBUG Получено записей: 2
2017-01-11 14:12:32.8481 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 14:12:32.8481 DEBUG Получено записей: 11
2017-01-11 14:12:32.8791 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 14:12:32.8861 DEBUG Получено записей: 75
2017-01-11 14:12:32.9391 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 14:12:32.9391 DEBUG Получено записей: 0
2017-01-11 14:12:42.7356 DEBUG Запрос: 
2017-01-11 14:13:11.2303 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 14:13:11.6653 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-11 14:13:11.6953 DEBUG Получено записей: 102
2017-01-11 14:13:11.7883 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-11 14:13:11.8243 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 14:13:11.8243 DEBUG Получено записей: 75
2017-01-11 14:13:37.0387 ERROR Cannot open connection: Failed to establish a connection to '192.168.16.253'.
2017-01-11 14:14:39.6403 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-11 14:14:39.6523 DEBUG Получено записей: 102
2017-01-11 14:14:39.7103 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-11 14:14:39.7393 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 14:14:39.7453 DEBUG Получено записей: 75
2017-01-11 14:19:36.8323 ERROR Cannot open connection: Failed to establish a connection to '192.168.16.253'.
2017-01-11 14:35:45.0237 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 14:35:45.0697 DEBUG Получено записей: 2
2017-01-11 14:35:51.0630 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 14:35:51.0630 DEBUG Получено записей: 11
2017-01-11 14:35:51.0790 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 14:35:51.0790 DEBUG Получено записей: 75
2017-01-11 14:35:51.1480 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 14:35:51.1520 DEBUG Получено записей: 0
2017-01-11 14:35:59.7975 DEBUG Запрос: 
2017-01-11 14:36:26.5831 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-11 14:36:26.6071 DEBUG Получено записей: 102
2017-01-11 14:36:26.7101 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-11 14:36:26.7461 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 14:36:26.7521 DEBUG Получено записей: 75
2017-01-11 14:39:02.3520 ERROR Cannot open connection: Failed to establish a connection to '192.168.16.253'.
2017-01-11 14:39:43.9014 DEBUG Запрос: 
2017-01-11 14:42:56.9194 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 14:42:57.2014 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-11 14:42:57.2114 DEBUG Получено записей: 102
2017-01-11 14:42:57.2664 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-11 14:42:57.2944 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 14:42:57.3014 DEBUG Получено записей: 75
2017-01-11 15:00:15.6248 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 15:00:15.6778 DEBUG Получено записей: 2
2017-01-11 15:00:22.1412 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 15:00:22.1412 DEBUG Получено записей: 11
2017-01-11 15:00:22.1582 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 15:00:22.1642 DEBUG Получено записей: 75
2017-01-11 15:00:22.2212 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 15:00:22.2272 DEBUG Получено записей: 0
2017-01-11 15:00:32.4658 DEBUG Запрос: 
2017-01-11 15:00:44.9135 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 15:18:20.9979 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 15:18:21.0439 DEBUG Получено записей: 2
2017-01-11 15:26:16.1791 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 15:26:16.2251 DEBUG Получено записей: 2
2017-01-11 15:57:34.4485 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 15:57:34.5005 DEBUG Получено записей: 2
2017-01-11 16:00:59.6002 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 16:00:59.6002 DEBUG Получено записей: 11
2017-01-11 16:00:59.6172 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 16:00:59.6262 DEBUG Получено записей: 75
2017-01-11 16:00:59.6932 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 16:00:59.6932 DEBUG Получено записей: 0
2017-01-11 16:01:13.9821 DEBUG Запрос: 
2017-01-11 16:10:15.6860 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 16:10:15.7380 DEBUG Получено записей: 2
2017-01-11 16:10:42.0616 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 16:10:42.0616 DEBUG Получено записей: 11
2017-01-11 16:10:42.0826 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 16:10:42.0896 DEBUG Получено записей: 75
2017-01-11 16:10:42.1486 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 16:10:42.1486 DEBUG Получено записей: 0
2017-01-11 16:10:50.6410 DEBUG Запрос: 
2017-01-11 16:14:06.4282 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 16:14:06.4792 DEBUG Получено записей: 2
2017-01-11 16:14:12.7656 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 16:14:12.7656 DEBUG Получено записей: 11
2017-01-11 16:14:12.7826 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 16:14:12.7826 DEBUG Получено записей: 75
2017-01-11 16:14:12.8486 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 16:14:12.8486 DEBUG Получено записей: 0
2017-01-11 16:14:23.9202 DEBUG Запрос: 
2017-01-11 16:16:48.9265 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 16:16:48.9765 DEBUG Получено записей: 2
2017-01-11 16:16:55.1919 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 16:16:55.1919 DEBUG Получено записей: 11
2017-01-11 16:16:55.2079 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 16:16:55.2079 DEBUG Получено записей: 75
2017-01-11 16:16:55.2689 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 16:16:55.2729 DEBUG Получено записей: 0
2017-01-11 16:17:19.1023 DEBUG Запрос: 
2017-01-11 16:21:27.9065 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 16:21:27.9525 DEBUG Получено записей: 2
2017-01-11 16:21:34.0708 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 16:21:34.0708 DEBUG Получено записей: 11
2017-01-11 16:21:34.0878 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 16:21:34.0938 DEBUG Получено записей: 75
2017-01-11 16:21:34.1478 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 16:21:34.1478 DEBUG Получено записей: 0
2017-01-11 16:22:01.0724 DEBUG Запрос: 
2017-01-11 16:22:12.8151 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-11 16:22:12.8671 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-11 16:22:12.8861 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-11 16:22:12.9291 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 16:22:12.9661 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-11 16:22:12.9661 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-11 16:22:12.9871 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-11 16:22:13.2611 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:22:13.3411 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:22:13.4061 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:22:13.4761 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:22:13.5331 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:22:13.5901 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:22:13.6461 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:22:13.7351 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:22:13.7861 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:22:13.8391 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:22:13.8971 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:22:13.9661 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:22:14.0411 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:22:14.1101 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 16:28:46.4466 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 16:28:46.4916 DEBUG Получено записей: 2
2017-01-11 16:28:53.2110 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 16:28:53.2110 DEBUG Получено записей: 11
2017-01-11 16:28:53.2280 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 16:28:53.2350 DEBUG Получено записей: 75
2017-01-11 16:28:53.2880 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 16:28:53.2880 DEBUG Получено записей: 0
2017-01-11 16:29:08.0898 DEBUG Запрос: 
2017-01-11 16:29:23.3397 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 16:32:14.4845 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 16:32:14.5305 DEBUG Получено записей: 2
2017-01-11 16:32:20.7048 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 16:32:20.7048 DEBUG Получено записей: 11
2017-01-11 16:32:20.7198 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 16:32:20.7198 DEBUG Получено записей: 75
2017-01-11 16:32:20.7798 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 16:32:20.7798 DEBUG Получено записей: 0
2017-01-11 16:32:37.3238 DEBUG Запрос: 
2017-01-11 16:32:48.5084 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 16:34:49.6013 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 16:34:49.6523 DEBUG Получено записей: 2
2017-01-11 16:35:03.8772 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 16:35:03.8772 DEBUG Получено записей: 11
2017-01-11 16:35:03.8942 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 16:35:03.8942 DEBUG Получено записей: 75
2017-01-11 16:35:03.9532 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 16:35:03.9582 DEBUG Получено записей: 0
2017-01-11 16:35:23.0653 DEBUG Запрос: 
2017-01-11 16:35:31.1297 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 16:35:32.9898 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-11 16:35:33.0768 DEBUG Получено записей: 102
2017-01-11 16:35:33.1738 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-11 16:35:33.2078 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 16:35:33.2078 DEBUG Получено записей: 75
2017-01-11 16:37:48.4886 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 16:41:01.7376 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 16:41:01.7836 DEBUG Получено записей: 2
2017-01-11 16:41:08.5080 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 16:41:08.5080 DEBUG Получено записей: 11
2017-01-11 16:41:08.5240 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 16:41:08.5300 DEBUG Получено записей: 75
2017-01-11 16:41:08.5840 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 16:41:08.5840 DEBUG Получено записей: 0
2017-01-11 16:41:17.1385 DEBUG Запрос: 
2017-01-11 16:41:27.0591 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 16:41:27.4961 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-11 16:41:27.5481 DEBUG Получено записей: 102
2017-01-11 16:41:27.6431 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-11 16:41:27.6791 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 16:41:27.6861 DEBUG Получено записей: 75
2017-01-11 17:04:13.9963 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 17:04:14.0363 DEBUG Получено записей: 2
2017-01-11 17:04:19.7896 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 17:04:19.7896 DEBUG Получено записей: 11
2017-01-11 17:04:19.8026 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 17:04:19.8086 DEBUG Получено записей: 75
2017-01-11 17:04:19.8816 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 17:04:19.8856 DEBUG Получено записей: 0
2017-01-11 17:04:27.9921 DEBUG Запрос: 
2017-01-11 17:04:40.3018 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 17:04:40.6588 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-11 17:04:40.6988 DEBUG Получено записей: 102
2017-01-11 17:04:40.7838 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-11 17:04:40.8188 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 17:04:40.8248 DEBUG Получено записей: 75
2017-01-11 17:05:33.1178 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 17:05:33.3358 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-01-11 17:05:33.3358 DEBUG Получено записей: 102
2017-01-11 17:05:33.3938 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                            where employee_type=1 and doc.expiration_date>@Date
                            order by 2                            
                            
2017-01-11 17:05:33.4188 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 17:05:33.4188 DEBUG Получено записей: 75
2017-01-11 17:06:10.9330 DEBUG Запрос: 
2017-01-11 17:06:29.2330 DEBUG Запрос: 
2017-01-11 17:06:32.7042 DEBUG Запрос: 
2017-01-11 18:09:19.1366 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 18:09:19.1816 DEBUG Получено записей: 2
2017-01-11 18:09:25.1970 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 18:09:25.1990 DEBUG Получено записей: 11
2017-01-11 18:09:25.1990 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 18:09:25.2190 DEBUG Получено записей: 75
2017-01-11 18:09:25.2740 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 18:09:25.2780 DEBUG Получено записей: 0
2017-01-11 18:09:32.4684 DEBUG Запрос: 
2017-01-11 18:13:10.2118 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-01-11 18:13:10.2638 DEBUG Получено записей: 2
2017-01-11 18:13:16.4352 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-01-11 18:13:16.4352 DEBUG Получено записей: 11
2017-01-11 18:13:16.4512 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-01-11 18:13:16.4572 DEBUG Получено записей: 75
2017-01-11 18:13:16.5102 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-01-11 18:13:16.5102 DEBUG Получено записей: 0
2017-01-11 18:14:04.2989 DEBUG Запрос: 
2017-01-11 18:14:33.3516 DEBUG Запрос: 
2017-01-11 18:14:47.0764 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.id = doc.users_id
                             order by 2
2017-01-11 18:14:51.3546 DEBUG Запрос: 
2017-01-11 18:15:19.8413 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-11 18:15:19.9003 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-11 18:15:19.9283 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-11 18:15:19.9553 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-01-11 18:15:19.9953 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-01-11 18:15:19.9953 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-11 18:15:20.0193 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-01-11 18:15:20.1433 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 18:15:20.2133 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 18:15:20.2933 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 18:15:20.3763 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 18:15:20.4493 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 18:15:20.5153 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 18:15:20.5913 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 18:15:20.6883 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 18:15:20.7563 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 18:15:20.8263 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 18:15:20.8923 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 18:15:20.9783 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 18:15:21.1303 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-01-11 18:15:21.2003 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
