2017-02-14 11:13:45.3945 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-02-14 11:13:45.4505 DEBUG Получено записей: 1
2017-02-14 11:13:49.1557 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2017-02-14 11:13:49.1557 DEBUG Parameters: @patterncode=, @operator=
2017-02-14 11:13:49.2027 DEBUG Result 
2017-02-14 11:13:49.2027 DEBUG нет шаблона для пользователя
2017-02-14 11:13:49.2027 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2017-02-14 11:13:49.2027 DEBUG Parameters: @patterncode 
2017-02-14 11:13:49.2167 DEBUG Result 
2017-02-14 11:13:49.2717 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null;
2017-02-14 11:13:49.2717 DEBUG Parameters: @patterncode=, @operator=
2017-02-14 11:13:49.2837 DEBUG Result 
2017-02-14 11:13:49.2837 DEBUG нет шаблона для пользователя
2017-02-14 11:13:49.2837 DEBUG SQL: select pattern from codifiers.patterns_tab where code = @patterncode and users_id is null
2017-02-14 11:13:49.2837 DEBUG Parameters: @patterncode 
2017-02-14 11:13:49.2967 DEBUG Result 
2017-02-14 11:13:49.9137 DEBUG Запрос: Select id, name, code, is_default, parent_id from codifiers.sp_kind_paid_tab order by id
2017-02-14 11:13:49.9177 DEBUG Получено записей: 9
2017-02-14 11:13:49.9177 DEBUG Запрос: Select id, name, code from codifiers.first_visit_condition_tab order by id
2017-02-14 11:13:49.9367 DEBUG Получено записей: 4
2017-02-14 11:13:49.9497 DEBUG Запрос: Select id, name, code, reestr, idsp, hospital_type_id, is_cure, is_inspection from codifiers.visit_purpose_common_tab order by id
2017-02-14 11:13:49.9497 DEBUG Получено записей: 22
2017-02-14 11:13:49.9677 DEBUG Запрос: Select id, name, code from codifiers.place_service_tab order by id
2017-02-14 11:13:49.9677 DEBUG Получено записей: 3
2017-02-14 11:13:49.9807 DEBUG Запрос: Select result_id, result, reestr, patient_state_id, reestr_rslt, reestr_ishod, _end from public.result_tab order by result_id
2017-02-14 11:13:49.9807 DEBUG Получено записей: 29
2017-02-14 11:13:50.0187 DEBUG Запрос: select id, name, code, bur_reestr_code from codifiers.travma_tab order by name;
2017-02-14 11:13:50.0187 DEBUG Получено записей: 15
2017-02-14 11:13:50.0347 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab
2017-02-14 11:13:50.0617 DEBUG Получено записей: 102
2017-02-14 11:13:50.5277 DEBUG Запрос: SELECT * FROM codifiers.lpu_tab order by name
2017-02-14 11:13:50.5277 DEBUG Получено записей: 102
2017-02-14 11:13:50.5527 DEBUG Запрос: select sp_napr_obosn_id,trim(obosn_name) as obosn_name FROM sp_napr_obosn_tab ORDER BY sp_napr_obosn_id;
2017-02-14 11:15:53.0488 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-02-14 11:15:53.0938 DEBUG Получено записей: 1
2017-02-14 11:15:57.5790 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-02-14 11:15:57.5790 DEBUG Получено записей: 11
2017-02-14 11:15:57.6000 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-02-14 11:15:57.6080 DEBUG Получено записей: 75
2017-02-14 11:15:57.6700 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-02-14 11:15:57.6700 DEBUG Получено записей: 0
2017-02-14 11:16:12.9099 DEBUG PatientFindForm ShowFilterByDoctor set to true
2017-02-14 11:16:12.9099 DEBUG PatientFindForm OperatorId: 2470
2017-02-14 11:16:12.9099 DEBUG PatientFindForm DoctorId: -1
2017-02-14 11:16:13.4819 DEBUG _loggedOperator.DoctorId==-1
2017-02-14 11:16:13.5069 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-02-14 11:16:13.5069 DEBUG Получено записей: 1
2017-02-14 11:16:13.5489 DEBUG _loggedOperator.DoctorId:-1
2017-02-14 11:31:50.7555 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login, clpu.name lpuname
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.dan_id = dan.dan_id
                            left join codifiers.lpu_tab clpu on doc.sp_lpu_id = clpu.id
                             where doc.expiration_date>@ExpDate  order by 2
2017-02-14 11:32:06.1114 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 11:32:06.1904 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:06.2204 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:06.2514 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-02-14 11:32:06.3224 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 11:32:06.3294 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:06.3484 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:14.2419 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:14.5779 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:14.6639 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:14.7599 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:14.8379 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:14.9119 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:14.9929 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:15.1089 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:15.1949 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:17.1990 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:17.2900 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:17.3591 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:17.4271 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:17.4971 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:18.6421 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 11:32:21.3723 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 11:32:22.7684 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 11:32:22.8004 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:23.4574 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:23.5394 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:23.6254 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:23.7054 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:23.7834 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:23.8614 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:23.9424 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:24.8585 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 11:32:24.8585 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:25.4565 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:26.0085 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:26.1006 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:26.1996 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:26.2816 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:26.3656 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:26.4466 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:27.8126 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 11:32:27.8306 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:28.5007 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:28.5827 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:28.6617 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:28.7667 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:28.8477 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:28.9247 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:29.0077 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:30.9218 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 11:32:30.9328 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:31.6019 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:31.7019 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:31.7909 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:31.8809 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:31.9699 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:32.0499 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:32.2059 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:33.4420 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 11:32:33.4420 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:34.1310 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:34.2260 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:34.3170 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:34.4070 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:34.4930 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:34.5720 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:34.6490 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:36.2721 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 11:32:36.2821 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:37.3412 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:37.4332 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:37.5292 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:37.6142 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:37.7022 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:37.7822 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:37.8612 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:39.1523 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 11:32:39.1623 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:39.8183 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:39.9013 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:39.9773 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:40.0954 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:40.1774 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:40.2624 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:40.3444 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:43.0405 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 11:32:43.0505 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:43.2025 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:43.7326 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:43.8586 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:43.9436 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:44.0276 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:44.1216 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:44.2096 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:46.5767 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 11:32:46.5877 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:47.1668 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:47.3248 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:47.4108 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:47.4968 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:47.5738 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:47.6558 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:47.7318 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:50.9690 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 11:32:50.9810 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 11:32:51.6900 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:51.7810 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:51.8700 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:51.9680 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:52.0470 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:52.1270 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:52.2090 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 11:32:53.6931 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 11:32:53.8041 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 11:32:53.9361 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 11:32:53.9591 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 11:32:54.0692 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 11:32:54.4842 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 11:32:54.5072 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 11:32:54.6112 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 11:32:55.1122 DEBUG Запрос: select id,name,color from codifiers.vid_talon_tab order by id 
2017-02-14 11:32:55.1282 DEBUG Запрос: select id,name,color from codifiers.vid_talon_tab order by id 
2017-02-14 11:58:19.9794 DEBUG Запрос: SELECT DISTINCT code_access, name, description 
                            FROM users_access_view WHERE users_id = @id
2017-02-14 11:58:20.0324 DEBUG Получено записей: 1
2017-02-14 11:58:24.9257 DEBUG Запрос: Select s.id, s.code, s.name from codifiers.sozstatus_tab s
2017-02-14 11:58:24.9257 DEBUG Получено записей: 11
2017-02-14 11:58:24.9427 DEBUG Запрос: Select u.id, u.code, u.name, u.doctor_id, u.otdel_id, u.age_from, u.age_for, u.flag_default, u.uchactok_type_id, u.lpu_id, u.sort, u.sex from codifiers.uchactok_tab u order by u.sort, u.name
2017-02-14 11:58:24.9497 DEBUG Получено записей: 75
2017-02-14 11:58:25.0007 DEBUG Запрос: select id, socr, name, full_name, index, code 
                              from codifiers.sp_kladr_tab
                              where level_ter=@level order by name
2017-02-14 11:58:25.0287 DEBUG Получено записей: 0
2017-02-14 13:20:04.9040 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname, 
                            doc.norma, doc.stavka, doc.dan_id patientid,doc.id id,doc.operator_id operatorid,
                            otd.name divisionname,
                            spec.name specialityname, dolg.name positionname, 
                            users.login login, clpu.name lpuname
                            from doctor_tab doc
                            left join codifiers.otdel_tab otd on otd.id=doc.sp_otdel_id
                            left join codifiers.doctor_spec_tab spec on spec.id=doc.sp_spec_doctor_id
                            left join codifiers.doctor_dolg_tab dolg on dolg.id=doc.sp_dolg_doctor_id
                            left join dan_tab dan on doc.dan_id = dan.dan_id
                            left join users_tab users on users.dan_id = dan.dan_id
                            left join codifiers.lpu_tab clpu on doc.sp_lpu_id = clpu.id
                             where doc.expiration_date>@ExpDate  order by 2
2017-02-14 13:20:16.8477 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 13:20:16.9087 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 13:20:16.9307 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 13:20:16.9617 DEBUG Запрос:  select dan.fam lastname, dan.nam firstname, dan.mid midname,
                            dan.date_born birthdate, 
                            case when dan.sex='м' then 1 else 2 end gender,
                            doc.id id,
                            doc.dan_id patientid,
                            doc.date_insert_doctor startdate,
                            doc.date_attestat_doctor certificationdate,
                            doc.federal_code fedcode,
                            doc.sp_dolg_doctor_id  positionid,
                            doc.sp_spec_doctor_id specialityid,
                            doc.stavka,
                            doc.norma,
                            doc.users_id login,
                            doc.sp_otdel_id divisionid,
                            doc.inner_doctor_code innercode,
                            doc.show_in_reg showinreg,
                            doc.description,
                            doc.expiration_date enddate,
                            doc.uet,
                            doc.payment paymentpercent,
                            doc.employee_type emptype,
                            doc.nurse_id nurseid,
                            doc.uchastok_id medareid,
                            doc.sim_pat_count sametimepatientcount,
                            doc.can_have_schedule canhaveschedule,
                            doc.max_records_per_day maxrecords
                            from doctor_tab doc
                            left join dan_tab dan on doc.dan_id = dan.dan_id 
                            where doc.id=@Id
                            
2017-02-14 13:20:17.0067 DEBUG Запрос:  select 
                                d.sp_spec_doctor_id as id, spec.name as name
                                from public.free_talon_tab ft 
                                inner join public.doctor_tab d on ft.doctor_id = d.doctor_id
                                inner join codifiers.doctor_spec_tab spec on d.sp_spec_doctor_id = spec.id
                                where d.show_in_reg=1 and spec.id!=900
                                group by d.sp_spec_doctor_id, spec.name
                                order by spec.name
2017-02-14 13:20:17.0997 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 13:20:17.1207 DEBUG Запрос:  SELECT doc.id id, d.fam lastname, d.nam firstname, d.mid midname, 
                            doc.inner_doctor_code innercode,
                            spec.name specialityname, spec.id specialityid
                            FROM public.dan_tab d 
                            left join doctor_tab doc on doc.dan_id = d.dan_id
                            inner join codifiers.doctor_spec_tab spec on doc.sp_spec_doctor_id = spec.id
                            where doc.sp_spec_doctor_id=@SpecId and doc.show_in_reg=1 and expiration_date>@Date
                            order by 2
2017-02-14 13:20:17.2907 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:19.9698 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:20.0588 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:20.1488 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:20.2419 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:20.3159 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:20.3889 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:20.5109 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:20.6049 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:20.6909 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:20.7769 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:20.8529 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:20.9369 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:21.0099 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:20:22.1950 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:25.8242 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:26.4462 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:26.5382 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:28.1423 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:28.1863 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:28.4143 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:28.5173 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:28.6263 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:29.0104 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:29.1944 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:29.5244 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:32.9636 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:33.0806 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:33.1786 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:33.3046 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:33.3306 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:33.4346 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:33.6586 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:34.0266 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:20:34.0866 DEBUG Запрос: select id,name,color from codifiers.vid_talon_tab where valid=true order by id 
2017-02-14 13:20:34.1026 DEBUG Запрос: select id,name,color from codifiers.vid_talon_tab where valid=true order by id 
2017-02-14 13:23:13.3618 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:14.8178 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:16.1269 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:16.1629 DEBUG Запрос: select id,name,color from codifiers.vid_talon_tab where valid=true order by id 
2017-02-14 13:23:16.1629 DEBUG Запрос: select id,name,color from codifiers.vid_talon_tab where valid=true order by id 
2017-02-14 13:23:25.7645 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:25.7935 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:26.2985 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:26.5185 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:26.5615 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:26.6625 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:26.6925 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:26.7755 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:27.1915 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:27.2385 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:27.3216 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:27.4626 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:27.9586 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:28.0856 DEBUG Запрос: select id,name,color from codifiers.vid_talon_tab where valid=true order by id 
2017-02-14 13:23:28.0996 DEBUG Запрос: select id,name,color from codifiers.vid_talon_tab where valid=true order by id 
2017-02-14 13:23:33.2039 DEBUG Запрос:  select exists(
                    select 1  
                    from free_talon_tab
                    where doctor_id=@DocId and time_talon=@TalonTime and date_talon=@DateTalon
                    )
2017-02-14 13:23:33.2289 DEBUG Запрос:  update free_talon_tab 
                            set vid_talon_id=@TalonType,
                            cabinet_id=@CabinetId,
                            cabinet_nam=@CabinetNam
                            where doctor_id=@DocId and time_talon=@TalonTime and date_talon=@DateTalon
2017-02-14 13:23:33.2979 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:23:33.8729 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:34.0059 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:34.1269 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:34.2349 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:34.3510 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:34.4540 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:34.5800 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:34.7910 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:34.9030 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:34.9260 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:35.0300 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:35.0510 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:35.0730 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:35.1870 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:36.0701 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:36.9661 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:37.1501 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:37.5501 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:37.6041 DEBUG Запрос: select id,name,color from codifiers.vid_talon_tab where valid=true order by id 
2017-02-14 13:23:37.6141 DEBUG Запрос: select id,name,color from codifiers.vid_talon_tab where valid=true order by id 
2017-02-14 13:23:37.6141 DEBUG Запрос: select id,name,color from codifiers.vid_talon_tab where valid=true order by id 
2017-02-14 13:23:41.7944 DEBUG Запрос:  select exists(
                    select 1  
                    from free_talon_tab
                    where doctor_id=@DocId and time_talon=@TalonTime and date_talon=@DateTalon
                    )
2017-02-14 13:23:41.7944 DEBUG Запрос:  update free_talon_tab 
                            set vid_talon_id=@TalonType,
                            cabinet_id=@CabinetId,
                            cabinet_nam=@CabinetNam
                            where doctor_id=@DocId and time_talon=@TalonTime and date_talon=@DateTalon
2017-02-14 13:23:41.8424 DEBUG Запрос:  select date_talon+time_talon talontime, 
                            ft.doctor_id doctorid, 
                            case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end talontype, 
                            ft.cabinet_nam cabinetname,
                            ft.cabinet_id cabinetid,
                            vt.name talontypename,vt.color talontypecolor, 
                            ft.reserve_patient_count reservedcount ,
                            tdt.dan_id patientid
                            from free_talon_tab ft
                            left join codifiers.vid_talon_tab vt on (case when ft.reserve_patient_count>0 then 7 else ft.vid_talon_id end)=vt.id
                            left join talon_doctor_tab tdt on tdt.doctor_id=ft.doctor_id and tdt.date_nazn=ft.date_talon and tdt.time_nazn=ft.time_talon
                            where ft.doctor_id=@DocId and date_talon=@Date
                            order by date_talon,time_talon
2017-02-14 13:23:42.3434 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:42.4544 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:42.5394 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
2017-02-14 13:23:42.6224 DEBUG Запрос:  select td.date_nazn+td.time_nazn talontime,
                            patdan.dan_id patientid,
                            coalesce(patdan.fam,'') || ' ' || coalesce(patdan.nam,'') || ' ' || coalesce(patdan.mid,'') patientfio,
                            patdan.address,
                            patdan.fakt_adr actaddress,
                            patdan.telephon,
                            patdan.med_karta_kod cardcode,
                            doc.id doctorid,
                            docdan.fam || ' ' || docdan.nam || ' ' || docdan.mid doctorfio,
                            td.cabinet_nam cabinet,
                            doc.doc_comment doccomment,
                            td.operator_id operatorid,
                            userdan.fam || ' ' || userdan.nam || ' ' || userdan.mid operatorfio,
                            td.programm_name || ' ' || td.integration_lpu "program",
                            td.date_vnes_inf editdate,
                            td.talon_operator_id operatoridprinted,
                            puserdan.fam || ' ' || puserdan.nam || ' ' || puserdan.mid operatorfioprinted,
                            td.talon_date_vnes_inf editdateprinted,
                            td.talon_programm_name programprinted,
                            td.mark_operator_id operatoridmarked,
                            muserdan.fam || ' ' || muserdan.nam || ' ' || muserdan.mid operatorfiomarked,
                            td.mark_date_vnes_inf editdatemarked,
                            td.mark_programm_name programmarked
                            from talon_doctor_tab td
                            left join doctor_tab doc on td.doctor_id=doc.id
                            left join dan_tab docdan on doc.dan_id = docdan.dan_id  
                            left join dan_tab patdan on td.dan_id = patdan.dan_id
                            left join users_tab users on td.operator_id = users.id
                            left join dan_tab userdan on users.dan_id = userdan.dan_id
                            left join users_tab pusers on td.talon_operator_id = pusers.id
                            left join dan_tab puserdan on pusers.dan_id = puserdan.dan_id
                            left join users_tab musers on td.mark_operator_id = musers.id
                            left join dan_tab muserdan on musers.dan_id = muserdan.dan_id
                            where td.doctor_id=@DocId and td.date_nazn=@Date and td.time_nazn=@Time
